贞明三年二月五日，晋军进攻黎阳，刘鄩击退了他们。
冬十月，晋王从魏州回太原。十二月，晋王从太原又到魏州。十五日，末帝驾临洛阳，因为明年将在南郊举行祭祀。
于是前往伊阙，亲自拜祭宣陵。
当时租庸使赵岩劝末帝在洛阳郊外祭天，并说： 帝王接受天命，必须行祭天大礼，愿陛下尽力做到。 
宰臣敬翔上奏说 ：国家从刘寻阝战败以来，仓库的积蓄用尽，靠一点点向老百姓征敛，供给军队都不够，郊祀的礼仪，需要金钱颁行赏赐，正是博取虚名而承受实际上的损耗。
况且晋人大军压境，御驾不可轻易行动。 
末帝不听从，于是前往洛阳。
本月，晋人攻陷杨刘城，末帝听到后感到害怕，于是停止南郊祭天的准备，御驾急归东京。
贞明四年春正月，晋军入寇郓州、濮州境内。御驾从洛阳回到东京。
二月，派将领谢彦章统帅数万之众进逼杨刘城。
二十一日，晋王前来救援杨刘城。谢彦章的军队作战失利而退。八月，晋军到达杨刘口，于是驻军在麻家渡，梁军北面招讨使贺瑰领兵屯驻在濮州北面的行台村，与晋军对阵一百多天。
晋王率领轻骑兵前来侦察，许州节度使谢彦章出动伏兵扑击，包围晋军几层，遇上晋军救兵来到，晋王只身逃脱。
十二月一日，晋王领军迫近行台寨，离寨十里扎营。
北面招讨使贺瑰杀害许州节度使谢彦章、濮州刺史孟审澄、别将侯温裕等人于军中，而以他们图谋叛逆罪上报朝廷。这是被行营马步都虞候朱王圭所挑拨陷害。
晋王闻讯后，高兴地说： 他们将帅不和，离灭亡就没有几天了。 
八日，以行营各军马步都虞候、光禄大夫、检校太保、曹州刺史朱王圭为检校太傅，充任匡国军节度观察留后，仍任行营各军马步都虞候。
十四日发布诏书说： 行营各军马步都虞候、匡国军节度留后朱王圭，前因敌寇未灭战火正炽之时，期望在朝夕之间，能平息战争之患，常在将帅之间，特别表现出忧虑劳苦，而谢彦章、孟审澄、侯温裕忽然产生不良意图，萌生叛逆的志向，有赖于朱王圭坚持气节，暗中运用深沉的智谋，终于擒获元凶，避免了增强敌人势力。
可封为检校太傅，兼任平卢军节度使，淄、青、登、莱等州观察使处置使、押新罗渤海两蕃使兼行营各军马步军副都指挥使，又进封为沛国郡开国侯。 二十四日，北面招讨使贺瑰率领大军与晋人在胡柳陂交战，晋人战败。
同日傍晚，又被晋人打败。
原先，晋人发兵准备袭击东京，于是下令宫中老弱全回到邺都，这月二十二日，晋王到达临濮，贺瑰、王彦章从行台寨领军跟踪他。
二十四日，到胡柳陂，晋王领兵出战，贺瑰军队已列成战阵，晋王领骑兵突击，王彦章一军首先战败，王彦章逃到濮阳。
晋军的辎重在阵地西边，贺瑰领军迫近它，晋军大乱逃奔，自相践踏，死者多得数不清，晋军大将周德威战死阵中。
贺瑰军于是占领一座土山，在山下列阵，晋王又领兵来交战。贺瑰军终于战败。第二天晋军攻打濮阳，占领了它，京师实行戒严。贞明五年春正月，晋军在德胜筑城，沿黄河两岸设营。
夏四月，贺瑰攻打德胜南城，用大船、战舰横亘黄河之中，以扼守渡口和过河的航道。晋军冲断大船，渡过部队支援南城，贺瑰等人退兵。
秋七月，晋王从魏州回到太原。
八月一日，滑州节度使贺瑰去世，末帝停止上朝三天，下诏追赠贺瑰为侍中。
这月，任命开封尹王瓒为北面行营招讨使。
王瓒于是与许州留后王彦章等领大军从黎阳渡过黄河，驻扎在杨村，造浮桥以通水路。
九月二日，诏令削夺广州节度使、南平王刘岩身任官职爵位，因为他准备超越本份改变名号称帝，图谋叛逆。
并诏令天下兵马元帅钱指挥攻讨。
冬十月，晋王又到魏州。
这月，刘寻阝攻下兖州，活捉叛将张守进，夷灭了他的全家。十二月五日，晋王领军迫近黄河南岸营寨，王瓒领军抵拒他，俘获晋军将领石家才。
不久王瓒军失利，王瓒退守杨村寨，晋军攻陷濮阳。

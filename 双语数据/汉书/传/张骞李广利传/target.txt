张骞是汉中人。建元年间被任命为郎官。
那时匈奴投降过来的人说匈奴攻破月氏王，并且用月氏王的头颅做酒器。月氏因此逃避而且怨恨匈奴，就是苦于没有人和他们一起打击匈奴。
汉王朝正想从事消灭匈奴的战争，听说此言，就想派人出使月氏，可匈奴国又是必经之路，于是就招募能够出使的人。
张骞以郎官的身份应募出使月氏。与堂邑氏的奴仆甘父一起离开陇西。
途经匈奴，被匈奴人截获，用传车送到单于那里。
单于说： 月氏在我的北边，汉朝人怎么能往那儿出使呢？
我如果想派人出使南越，汉朝肯任凭我们的人经过吗？ 
扣留张骞十多年。给他娶妻，并生了儿子，然而张骞仍持汉节不失使者身分。
因居住在匈奴西部，张骞趁机带领他的部属一起向月氏逃亡。往西跑了几十天，到了大宛。
大宛听说汉朝财物丰富，想和汉朝交往可找不到机会。见到张骞非常高兴，问他要到哪里去。
张骞说： 替汉朝出使月氏，而被匈奴封锁道路，不让通行，现在逃亡到贵国，希望大王能派人带路，送我们去，假如能够到达月氏，我们返回汉朝后，汉朝送给大王的财物，一定多得不可尽言。 
大宛认为可以，就送他们去，并为他们派遣了翻译和向导。
送到康居，康居用传车将他们送到大月氏。
这时，原来的大月氏王已被匈奴所杀，立了他的夫人为王。
大月氏已经使大夏臣服并统治着它。
他们那里土地肥沃，出产丰富，没有侵扰，心境悠闲安乐，又自认为距离汉朝遥远而不想亲近汉朝，全然没有向匈奴报仇的意思。张骞从月氏到大夏，始终得不到月氏王明确的表示。
逗留一年多后，只得返程。沿着南山，想从羌人居住的地方回到汉朝，又被匈奴截获。
扣留一年多，碰巧单于死了，匈奴国内混乱，张骞便带着他匈奴籍的妻子以及堂邑甘父一起逃跑回到了汉朝。
朝廷授予他太中太夫官职，堂邑甘父也当上了奉使君。
张骞为人坚强而有毅力，宽宏大量，待人真诚，少数民族人喜欢他。
堂邑父是匈奴人，善于射箭，在穷困至极的时候，就射取禽兽作为食物。
当初，张骞出行时有一百余人，去了十三年，只有他和堂邑父两人回来。
张骞亲身所到过的地方，有大宛、大月氏、大夏、康居等国，他听说在这些国家的旁边还有五六个大国，他一一向汉武帝讲述了这些国家的地形和物产。所说的内容都在《西域传》裹。
张骞说： 我在大夏的时候，见到邛那个地方的竹杖和蜀郡产的细布，问他们是从哪里获得的，大夏国人说： 是我国的商人从身毒国买来的。
身毒国在大夏东南，大约有数千里地。
那裹的风俗是过着定居的生活，和大夏相同，但地势低洼，潮湿，气候炎热。
那里的人骑着大象打仗，国家滨临大水，根据我的推测，大夏距离汉朝约有一万二千里，在汉朝的西南。
现在身毒又在大夏东南数千里，有蜀郡的物产，这样看来，身毒距离蜀不远。
现在出使大夏，从羌族地区经过，很危险，羌族人很厌恶汉朝；稍稍往北，则会被匈奴人俘获；如果从蜀郡走，当是方便的道路，又无侵扰。 
漠武帝听说大宛和大夏、安息等国家都是大国，有许多奇怪的物产，又过着定居的生活，与汉朝的风俗相同。而兵力很弱，很看重汉朝的财物；其北方则是大月氏、康居等国，兵力强大，可以用赠送财物、给他们以好处的方法，诱使他们前来朝见汉天子。
果真能够这样做并用道义的力量使他们归附汉朝，那么汉朝就可扩大疆土一万余里，有些民族的人到朝廷来，要经多重翻译才能通晓语言，一些奇风异俗的少数民族也前来归附，汉朝的威望德泽就可普及四海。
汉武帝很高兴，认为张骞说得很有道理。
于是下令通过蜀郡和犍为郡派遣探路的使者，分四路同时出发。一路从冉驰出发，一路从榨都出发，一路从徙和邛出发，一路从焚出发，各有一二千里路程。
可是北方的通道为氏族和榨都夷所阻挡，南方的通道为岭和昆明所阻。
昆明等少数民族没有君长，善于劫掠和盗窃。每每杀害过往的汉使，夺走财物，这条路终于没能打通。
不过听说昆明西边大约千余里的地方，有乘象国，名叫滇越，蜀郡有些私自往来买卖货物的商人到过那儿。于是汉朝因寻求通往大夏的道路而开始与滇国往来。
当初，汉朝想与西南夷通使，由于费用太多，停止了这项工作。
及至张骞说可经西南夷通往大夏，汉朝才着手打通西南夷之路。
张骞以校尉的身份跟随大将军卫青出击匈奴，因为他了解水草分布的地方，军队才能不缺给养，于是封张骞为博望侯。
这年是汉武帝元朔六年。
两年以后，张骞作为卫尉，与李广将军一起从右北平出发抗击匈奴。
李将军被匈奴包围，汉军伤亡惨重，而张骞晚于约定的时间到达，按军法当处以斩刑，他用财物赎为平民。
这一年，骠骑将军霍去病在西边打败匈奴，杀数万，直至祁连山。
秋天，匈奴浑邪王率领他的部众投降汉朝。于是，从金城、河西走廊，沿祁连山直至盐泽一带空无匈奴。
匈奴时或有侦察兵前来，但也为数甚少。
又过了两年，汉朝击退匈奴单于并赶往漠北。
汉武帝多次向张骞询问大夏等国的情况。
此时张骞已失去了侯的封号，就回答道 我住在匈奴的时候，听说乌孙王名昆莫。
昆莫的父亲难兜靡本来和大月氏都住在祁连山、敦煌一带，是个小国。
大月氏攻打杀害了难兜靡，抢占了他的土地，乌孙人逃亡投奔匈奴。
难兜靡的儿子昆莫那时刚出生不久，傅父布就翎侯抱着他逃亡，途中将他放在草丛中，去为他寻找食物。回来时，见狼正在给他喂奶，又有乌鸦衔着肉在他旁边盘旋，以为昆莫是神，就抱着昆莫归附匈奴，单于喜欢他，将他抚养成人。
昆莫长大后，单于把他父亲的民众交还给他，让他带兵打仗，昆莫屡次建立战功。
那时，月氏已被匈奴打败，向西进攻塞王。
塞王南巡迁往远方，月氏人便居住在塞王的地盘上。
昆莫的力量壮大后，亲自请求单于允许他替父报仇，于是向西攻败大月氏。
大月氏人再次西逃，迁往大夏人居住的地方。
昆莫掠夺其民众，就留居在大月氏人的土地上，兵力逐渐强大起来，正好碰上匈奴单于死，于是不肯再入朝事奉匈奴。
匈奴派军队攻打他，无法战胜，更认为昆莫是神而远离他。
如今单于刚被汉朝打败，处于窘困的境地，而昆莫原来的地方无人居住。
少数民族依恋故土，又贪心汉朝的财物，如果在此时多多地送些财物给乌孙，招引他们到束边来居住在原来的土地上，汉朝送公主给乌孙王作夫人，双方结为兄弟关系，根据以上对形势的分析，乌孙一定会听从我们的建议，那么造就等于切断了匈奴的右臂。
联合了乌孙，自乌孙以西的大夏等国，都可招来而为您的外臣。 
汉武帝认为张骞说得对，授予张骞中郎将的官职，率领三百人，每人马各二匹，赶着上万计的牛羊，随身携带价值数千万万的黄金和礼物，还有许多持节副使随行，出使乌孙。
道路方便的话，就派持节副使出使乌孙旁边的国家。
张骞到达乌孙后，将汉武帝的礼物送给乌孙王并转达了汉武帝的旨意，但未能获得乌孙王的明确表态。具体内容记载在《西域传》裹。张骞便分别派遣副使出使大宛、康居、月氏、大夏。
乌孙王派翻译向导护送张骞。乌孙使者数十人，马数十匹随张骞回汉朝答谢汉武帝，趁机让他们察看汉朝的情况，了解到了汉朝的广大。
张骞返回汉朝，被授予大行官。
一年多后，张骞去世。
又过了一年多，他所派遣去通大夏等国的副使大都与这些国家的使节一同回到汉朝，于是西北各国开始与汉朝来往。
不过由于张骞开辟了通往西域的道路，后来出使西域的人都仿效张骞，称博望侯，以此来取信于外国，外国人因此而信任他们。
那以后，乌孙王终于与选公主结婚。
当初，汉武帝打开《易》书占卜，说： 神马当从西北来。 
得了乌孙马觉得好，给它起名为 天马 。
等到又得了大宛汗血马，它比乌孙马更加膘壮，便将乌孙马改名为 西极马 ，称大宛马为 天马 。
并且汉朝开始从令居向西筑塞，新设酒泉郡，以便于通往西域各国。
汉朝于是增派使者到安息、奄蔡、牦轩、条支、身毒国。
且漠武帝喜欢大宛马，出使西域的使者相望于道，一批多者数百人，少者百余人，所携带的东西，完全仿效博望侯张骞时的盛况。
其后，随着对西域情况的曰益熟悉，每批使者的人数也是越来越少。
汉朝时大概一年中使者多者十余批，少者五六批，远的八九年，近的几年就可往返。
这个时候，汉朝已灭了南越，与蜀郡相通的西南夷都很震动，他们请求汉朝在那儿设治并派官吏进行治理。
汉朝在西南夷设置了烊柯、越岭、益州、沈黎、文山郡，想用在西南夷设郡的办法，地界相接，向前通往大夏。
于是汉朝每年派使者十余批，从这些新设置的郡出发，但都再次被昆明夷所阻绝，漠使被杀、礼品遭劫。
于是汉朝发兵出击昆明，斩首数万。
后来又派使者，终不能通过。
详情在《西南夷传》裹。
自从张骞开辟了通往西域的道路而获得尊贵的地位，那些吏士争着上书谈论外国物产的稀奇古怪以及通使的利害关系，请求出使。
汉武帝因为西域偏僻遥远，并非人人都乐意去，便接受他们的言论，给予出使的符节，招募官吏和百姓而不问应募者的身份资历，为这些人准备好随行人员打发他们出使，以此扩大出使西域人员的来源。
这些人回来时，难免有劫掠和盗窃来的财物，以及执行使命时违背汉武帝的旨意，汉武帝因为他们熟悉西域的情况，就每每审查他们并致以重罪，以激发他们发奋去立功赎罪，再次请求出使西域。
出使西域的缘由无穷无尽，且轻视犯法。
那些吏卒也每每一再地推崇外国的物产，夸张程度大的，被给予符节，为正使，夸张程度小的为副使。故无稽之谈者及无良好品行之徒都争相仿效。
使者们大都将天子送给西域各国的礼物据为己有，想以较低的价格卖出以从中牟利。
外国人也厌恶汉使人人言语轻重不实，估计路远汉军不能到达，便断绝汉使的食物供应，使他们陷于困苦的境地。
汉使生活穷困，谴责抱怨，以至于相互攻击。
楼兰、姑师等小国，地处交通要道，攻击、劫掠汉使王恢等尤为厉害，且匈奴奇兵更是时时截击汉使。
使者们争相谈论征服这些国家对汉朝有利，不讨伐它则对汉朝有害，这些国家都有城邑，军队战斗力弱，易于攻击。
于是汉武帝派从票侯赵破奴，率领西域各属国骑兵及各郡兵力数万人反击匈奴，匈奴士兵全都逃窜。
第二年，赵破奴击败姑师，俘虏了楼兰王。
汉朝从酒泉郡起布列了边防哨所，直至玉门关。
大宛诸国派使者随汉使来到汉朝，看到汉朝的广大，他们向汉朝献上驼鸟卵和牦轩的幻术家，汉武帝非常高兴。
汉使穷尽黄河的源头，那里的山多玉石，汉使采来运回汉朝，汉武帝查考了古地图书籍，将黄河源头所出之山命名为昆仑山。
这时，汉武帝正好多次到海边视察，身边竟全是外国客人跟随着。凡属大的城市或人多的地方就打那儿经过，散发财物布帛进行赏赐，备办丰厚的礼物送给他们，以此来展示汉朝财力雄厚。
表演大角抵、奇戏等新奇的东西，引来众多的围观者，大行赏赐。让外国客人遍观汉朝各仓库府藏的储积，想以此显示汉朝的广大，使他们对汉朝的强大既佩服又诧异。
至于增加幻术家的技艺，角抵、奇戏花样的年年增变，它们的进一步兴起，就是从汉武帝时开始的。
且外国使者不断地交替往来，络绎不绝。
大宛以西的国家都自恃离汉朝遥远，还是骄傲放纵，汉朝没能使他们屈服，就用礼尚往来的方式与他们保持联系，出使这些国家。
汉朝出使到西域的人已很多，那些少年从使多用虚美的言辞怂恿汉武帝，说大宛有好马在贰师城，藏起来不肯让汉使看到。
汉武帝喜欢宛马，听说后一心想得到它，他派壮士车令等带着千金和金马去请求大宛王送给贰师城好马。
大宛国有许多汉朝财物，他们互相商量道： 汉朝离我们很远，且人从盐泽一带经过每有死亡，从它的北面经过有匈奴的骚扰，从南面来则缺乏水草，加上沿途处处没有城邑，缺乏食物的情况经常发生。
汉使一批数百人前来，常常缺乏食物。死者过半。这样的情况怎么能派大军来呢？
况且贰师马是大宛的宝马啊。 
终不肯给汉使。
汉使大怒，痛骂一通，椎破金马而去。
大宛国的贵臣们怒道： 汉使太轻视我们了！ 
命令汉使离开大宛国，又让束边的郁成王拦击他们，杀害汉使夺取他们的财物。
汉武帝大怒。
曾出使过大宛的姚定汉等人说： 大宛兵弱，若用近三千的汉军，强弓劲弩向他们射击，便可打败他们。 
汉武帝因曾派浞野侯赵破奴攻打楼兰，以七百骑兵先到楼兰，俘虏了楼兰王，故认为姚定汉等人言之有理，而想封宠姬李夫人的兄弟为侯，便以李广利为将军讨伐大宛。
张骞的孙子张猛，字子游，颇有才智，元帝时为光禄大夫，出使过匈奴，加官给事中，被石显陷害而自杀。
李广利的妹妹李夫人有宠于皇上，生昌邑哀王。
太初元年，以广利为贰师将军，带领属国的六千骑兵和郡国那些品行恶劣的少年好几万人，以这些兵力去攻伐大宛，预期到贰师城夺取良马，所以叫他 贰师将军 。
原浩侯王恢为军队带路做向导官。
贰师将军的部队已经西遇盐水，沿路的那些小国家恐慌，都各自紧紧地守住自己的城堡，不供给汉军粮食，打又打不下来。
能攻下来的就有饭吃，不能攻下来的，只好几天就离开。
等到达郁成，兵士只有几千人了，都饥饿疲乏。
攻打郁成城，大败，死伤的人很多。
贰师将军和左右商议： 至郁成还不能攻下它，何况到大宛王都城呢？ 
就带着部队撤退。
往返花了两年，回到敦煌，士兵剩下不过十分之一。
派遣使者给皇帝上奏章说： 路程遥远十分缺乏粮食。士兵们不怕打仗，衹怕挨饿。
兵少，不能攻取宛国。
希望暂且撤兵，多派兵后再去。 
汉武帝得知所奏，大发雷霆，派使者拦守玉门关，说军人敢有入关者立即斩了他！
贰师将军李广利害怕了，因而留驻敦煌。
那年夏天，汉朝对匈奴作战，浞野侯趟破奴的士兵损失二万多人。汉朝廷高级官员商议都希望调回攻打大宛的军队，专力对付匈奴。
汉武帝却认为既已出兵讨伐大宛，如大宛这样的小国都打不下来，那大夏之类的国家会渐渐瞧不起汉朝，大宛的良马就断绝来汉，乌孙、轮台等国家也将随便难为汉朝的使者，就会见笑于外国。
于是就惩治了议论攻打大宛尤为不当的邓光等人。
赦免了那些囚徒步卒，增发了那些品行恶劣的少年和边境的骑兵，经过一年多而从敦煌出兵六万人，私人带着粮食跟随部队参战的还不计算在内。
这支队伍带有牛十万头，马三万匹，驴、骆驼以万数计算。
他们多带粮食，兵器、弓箭等极为齐备。全国骚扰动荡，相继供应征伐大宛，军队总共有五十余校尉军官出征。
大宛都城内没有水井，都要从城外引进流水，于是漠军就派治水的工匠改道城下水，不使流经城下，而引水入孔穴之内，以水攻城内。
汉朝还增派甲卒十八万人到酒泉和张掖以北驻守，并新置了居延和休屠两个县以卫护酒泉。
而征发天下 七科适 ，载运干粮以供给贰师将军，驱车载运的人众络绎相连到敦煌。
而授任两名会相马的人为执驱马校尉，准备在攻破大宛以后选取良马。
这时贰师将军是二次出征，队伍庞大，所至沿途各个小国无不迎接，拿出粮食供养军队。
到轮台国，轮台国不降，攻战几天，血洗了他们。
从此往西，平安行军到达了大宛王都，漠兵到达者三万人。
宛军迎战汉军，汉军射败了他们，宛军逃到城堡内凭藉城墙守卫。
贰师将军的部队本想进军先攻郁成城，恐怕军队滞留而使大宛人更生诈谋，于是就先攻大宛城，决开他们的水源，改变其流向，即使大宛坚守也甚感忧愁困窘。
包围大宛的城池，攻城四十多天。
他们的高级官员相互商量道： 汉朝之所以来攻打大宛，是我们国王毋寡隐藏了好马而杀害了汉朝使者。
如果杀掉国王毋寡并拿出好马，漠军之围当可解脱；即使不解，再奋战而死，也为时不晚。 
大宛的高级官员们都认为这样对，共同杀死宛王毋寡。
它的外城被摧毁，俘获了大宛贵人勇将煎靡。大宛人大为震惊，逃跑入守中城，相互商量说： 汉来攻打宛，是因为国王毋寡。 提着他的头派人去见贰师将军，相约说： 汉军不要攻打我们了，我们把好马全部拿出来，任凭你们选取，并且供给你们粮食。
如若不听从，我们杀尽好马，而康居的救兵将要到达。
一到达，我宛兵在城内，康居的救兵在城外，共同和汉军作战。
汉军仔细考虑吧，怎么办？ 
这时康居侦探窥伺漠兵，汉兵还很强大，不敢进兵。
贰师将军听说大宛城内最近找到了汉人，会穿井汲水，而且城内粮食还多。
考虑到我们之所以来，就是为诛灭罪魁祸首宛王毋寡，毋寡的头已经到了，这样还不允许解开兵围，那么他们就会坚守，而康居等到汉军疲乏时而来援救大宛，那打败汉军是必然的了。
军官们都认为对，就接受了大宛的许约。
大宛人就放出他们的好马，让汉兵自行挑选，还拿出许多粮食供养汉军。
汉军挑选了好马几十匹，中等以下公马母马共三干多匹，而且立大宛高级官员中过去待汉人友好的昧蔡为大宛国王，与他订立盟约后撤兵。终于不得进入大宛内城，就结束这场战争撤兵回来了。
当初，贰师将军发兵敦煌西进时，认为人多，沿路各国无法供给粮食，就分为几支队伍，从南北两路挺进。
校尉王申生和原大鸿胪壶充国等统领一支千多人的队伍另到郁成，郁成人坚守城堡，不肯把粮食供给他们。
王申生的部队距离贰师将军的大部队二百里，他依仗大军而轻视对方，急攻郁成。
郁成人窥探得知王申生的部队少，就在一个早晨用三千人的兵力发起攻击，斩杀了王申生等人，军队大败，衹有几个人脱险逃出，跑到贰师将军那裹。
贰师将军命令搜粟都尉上宫桀去攻打郁成，郁成投降，郁成王逃走到康居国，上官桀就追到康居国。
康居国人听说汉军已经打败大宛，就交出郁成王给上官桀。上官桀派四个骑士把他捆绑看守押送给主将李广利。
这四个人互相议论说： 郁成王是汉朝所痛恨的，如果把他活着送去，怕突然发生意外，贻误大事。 
想杀，没有人敢先动手。
上邹骑士趟弟拔剑斫击，斩了郁成王。
上官桀等就赶上了贰师将军的大部队。
当初，贰师将军李广利后一次出兵，皇上派遣使者通告乌孙国，要它出兵与漠军合力攻宛。
乌孙派遣两千名骑兵前往，徘徊观望，不敢上前。
贰师将军的队伍凯旋东归，所经过的那些小国听说大宛已被攻破，都打发自己的子弟跟随汉军去纳献贡物，谒见天子，因而作为人质。
军队返回，进入玉门关的有一万多人，军马一千多匹。
贰师将军后一次行军，军队并非缺乏食用，牺牲的也不能算多，而是将吏们贪财，大都不爱护士兵，侵吞军饷，因此死亡很多。
天子因为是远涉万里征讨大宛，就不责问他们的过失，便下诏说： 匈奴为害很久了，如今虽远徙漠北，与旁国共谋截击大月氏国使臣，拦杀中郎将江及原雁门太守攘。
危须国以西及大宛皆合约杀期门车令、中郎将朝及身毒国使，隔断东西道路。
贰师将军广利征讨其罪，战胜大宛。
赖天之灵，从溯河山，涉流沙，通西海，雪不积，士大夫直接穿过，获王首级，珍怪之物都陈列于庭。
封李广利为海西侯，食邑八千户。 
又封斩杀郁成王的赵弟为新时侯；军正趟始成功最多，为光禄大夫；上官桀敢深入，为少府；李哆有计谋，为上党太守。
军官中被封为九卿的有三人，诸侯相、郡守、二千石级官吏的有一百多人，一千石级官吏以下的一千多人。
自愿参加者赏封的官爵都超过他们本人的愿望，因犯罪受惩罚而去从军的人免罪但不计功劳。
士兵们所得赏赐约值四万钱。
攻伐大宛两回，总共经历四年才告结束。
后十一年，征和三年，贰师将军又率七万骑兵出五原，攻击匈奴，渡郅居水。
兵败，投降匈奴，被单于杀死。
事见《匈奴传》。
赞曰：《禹本纪》记载黄河源于昆仑山，昆仑山高二千五百余里，山上的光明凭着曰月交替隐避而得到。
自张骞出使大夏之后，走到了黄河的尽头，没有看到所说的昆仑山吗？
因此讲九州山川，《尚书》比较可信。
至于《禹本纪》、《山经》所记载，无甚根据，不可信！

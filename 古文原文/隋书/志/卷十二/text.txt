律历中
夫历者，纪阴阳之通变，极往数以知来，可以迎日授时，先天成务者也。然则悬象著明，莫大于二曜，气序环复，无信于四时。日月相推而明生矣，寒暑迭进而岁成焉，遂能成天地之文，极乾坤之变。天数五，地数五，五位相乘而各有合。天数二十有五，地数三十，凡天地之数五十有五，所以成变化而行鬼神也。乾之策二百一十有六，坤之策一百四十有四，凡三百六十，以当期之日也。至乃阴阳迭用。刚柔相摩，四象既陈，八卦成列，此乃造文之元始，创历之厥初者欤？洎乎炎帝分八节，轩辕建五部，少昊以凤鸟司历，颛顼以南正司天，陶唐则分命和仲，夏后乃备陈《鸿范》，汤武革命，咸率旧章。然文质既殊，正朔斯革，故天子置日官，诸侯有日御，以和万国，以协三辰。至于寒暑晦明之徵，阴阳生杀之数，启闭升降之纪，消息盈虚之节，皆应躔次而不淫，遂得该浃生灵，堪舆天地，开物成务，致远钩深。周德既衰，史官废职，畴人分散，禨祥莫理。秦兼天下，颇推五胜，自以获水德之瑞，以十月为正。汉氏初兴，多所未暇，百有余载，犹行秦历。至于孝武，改用夏正。时有古历六家，学者疑其纰缪，刘向父子，咸加讨论，班固因之，采以为志。光武中兴，未能详考。逮于永平之末，乃复改行四分，七十余年，仪式方备。其后复命刘洪、蔡邕，共修律历，司马彪用之以续《班史》。当涂受命，亦有史官，韩翊创之于前，杨伟继之于后，咸遵刘洪之术，未及洪之深妙。中、左两晋，迭有增损。至于西凉，亦为蔀法，事迹纠纷，未能详记。宋氏元嘉，何承天造历，迄于齐末，相仍用之。梁武初兴，因循齐旧，天监中年，方改行宋祖冲之《甲子元历》。陈武受禅，亦无创改。后齐文宣，用宋景业历。西魏入关，行李业兴历。逮于周武帝，乃有甄鸾造《甲寅元历》，遂参用推步焉。大象之初，太史上士马显，又上《丙寅元历》，便即行用。迄于开皇四年，乃改用张宾历，十七年，复行张胄玄历，至于义宁。今采梁天监以来五代损益之要，以著于篇云。
梁初因齐，用宋《元嘉历》。天监三年下诏定历，员外散骑侍郎祖恆奏曰： 臣先在晋已来，世居此职。仰寻黄帝至今十二代，历元不同，周天、斗分，疏密亦异，当代用之，各垂一法。宋大明中，臣先人考古法，以为正历，垂之于后，事皆符验，不可改张。 八年，恆又上疏论之。诏使太史令将匠道秀等，候新旧二历气朔、交会及七曜行度，起八年十一月，讫九年七月，新历密，旧历疏。恆乃奏称： 史官今所用何承天历，稍与天乖，纬绪参差，不可承案。被诏付灵台，与新历对课疏密，前期百日，并又再申。始自去冬，终于今朔，得失之效，并已月别启闻。夫七曜运行，理数深妙，一失其源，则岁积弥爽。所上脱可施用，宜在来正。 至九年正月，用祖冲之所造《甲子元历》颁朔。至大同十年，制诏更造新历，以甲子为元，六百一十九为章岁，一千五百三十六为日法，一百八十三年冬至差一度，月朔以迟疾定其小余，有三大二小。未及施用而遭侯景乱，遂寝。
陈氏因梁，亦用祖冲之历，更无所创改。后齐文宣受禅，命散骑侍郎宋景业叶图谶，造《天保历》。景业奏：依《握诚图》及《元命包》，言齐受录之期，当魏终之纪，得乘三十五以为蔀，应六百七十六以为章。 文宣大悦，乃施用之。期历统曰： 上元甲子，至天保元年庚午，积十一万五百六算外，章岁六百七十六，度法二万三千六百六十，斗分五千七百八十七，历余十六万二千二百六十一。 至后主武平七年，董峻、郑元伟立议非之曰： 宋景业移闰于天正，退命于冬至交会之际，承二大之后，三月之交，妄减平分。臣案，景业学非探赜，识殊深解，有心改作，多依旧章，唯写子换母，颇有变革，妄诞穿凿，不会真理。乃使日之所在，差至八度，节气后天，闰先一月。朔望亏食，既未能知其表里，迟疾之历步，又不可以傍通。妄设平分，虚退冬至，虚退则日数减于周年，平分妄设，故加时差于异日。五星见伏，有违二旬，迟疾逆留，或乖两宿。轨褵之术，妄刻水旱。今上《甲寅元历》，并以六百五十七为章，二万二千三百三十八为蔀，五千四百六十一为斗分，甲寅岁甲子日为元纪。 又有广平人刘孝孙、张孟宾二人，同知历事。孟宾受业于张子信，并弃旧事，更制新法。又有赵道严，准晷影之长短，定日行之进退，更造盈缩，以求亏食之期。刘孝孙以百一十九为章，八千四十七为纪，九百六十六为岁余，甲子为上元，命日度起虚中。张孟宾以六百一十九为章，四万八1千九百为纪，九百四十八为日法，万四千九百四十五为斗分。元纪共命，法略旨远。日月五星，并从斗十一起。盈缩转度，阴阳分至，与漏刻相符，共日影俱合，循转无穷。上拒春秋，下尽天统，日月亏食及五星所在，以二人新法考之，无有不合。其年，讫干敬礼及历家豫刻日食疏密。六月戊申朔，太阳亏，刘孝孙言食于卯时，张孟宾言食于甲时，郑元伟、董峻言食于辰时，宋景业言食于巳时。至日食，乃于卯甲之间，其言皆不能中。争论未定，遂属国亡。
西魏入关，尚行李业兴《正光历》法。至周明帝武成元年，始诏有司造周历。于是露门学士明克让、麟趾学士庾季才及诸日者，采祖恆旧议，通简南北之术。自斯已后，颇观其谬，故周、齐并时，而历差一日。克让儒者，不处日官，以其书下于太史。及武帝时，甄鸾造《天和历》。上元甲寅至天和元年丙戌，积八十七万五千七百九十二算外，章岁三百九十一，蔀法二万三千四百六十，日法二十九万一百六十，朔余十五万三千九百九十一，斗分五千七百三十一，会余九万三千五百一十六，历余一十六万八百三十，冬至斗十五度，参用推步。终于宣政元年。大象元年，太史上士马显等，又上《丙寅元历》，抗表奏曰：
臣案九章五纪之旨，三统四分之说，咸以节宣发敛，考详晷纬，布政授时，以为皇极者也。而乾维难测，斗宪易差，盈缩之期致舛，咎徵之道斯应。宁止蛇或乘龙，水能沴火，因亦玉羊掩曜，金鸡丧精。王化关以盛衰，有国由其隆替，历之时义，于斯为重。自炎汉已还，迄于有魏，运经四代，事涉千年，日御天官，不乏于世，命元班朔，互有沿改。验近则叠璧应辰，经远则连珠失次，义难循旧，其在兹乎？大周受图膺录，牢笼万古，时夏乘殷，斟酌前代，历变壬子，元用甲寅。高祖武皇帝索隐探赜，尽性穷理，以为此历虽行，未臻其妙，爰降诏旨，博访时贤，并敕太史上士马显等，更事刊定，务得其宜。然术艺之士，各封异见，凡所上历，合有八家，精粗踳驳，未能尽善。去年冬，孝宣皇帝乃诏臣等，监考疏密，更令同造。谨案史曹旧簿及诸家法数，弃短取长，共定今术。开元发统，肇自丙寅，至于两曜亏食，五星伏见，参校积时，最为精密。庶铁炭轻重，无失寒燠之宜，灰箭飞浮，不爽阴阳之度。上元丙寅至大象元年己亥，积四万一千五百五十四算上。日法五万三千五百六十三，亦名蔀会法。章岁四百四十八，斗分三千一百六十七，蔀法一万二千九百九十二。章中为章会法。日法五万三千五百六十三，历余二万九千六百九十三，会日百七十三，会余一万六千六百一十九，冬至日在斗十二度。小周余、盈缩积，其历术别推入蔀会，分用阳率四百九十九，阴率九。每十二月下各有日月蚀转分，推步加减之，乃为定蚀大小余，而求加时之正。
其术施行。时高祖作辅，方行禅代之事，欲以符命曜于天下。道士张宾，揣知上意，自云玄相，洞晓星历，因盛言有代谢之徵，又称上仪表非人臣相。由是大被知遇，恆在幕府。及受禅之初，擢宾为华州刺史，使与仪同刘晖、骠骑将军董琳、索卢县公祐、前太史上士马显、太学博士郑元伟、前保章上士任悦、开府掾张撤、前荡边将军张膺之、校书郎衡洪建、太史监候粟相、太史司历郭翟、刘宜、兼算学博士张乾叙、门下参人王君瑞、荀隆伯等，议造新历，仍令太常卿卢贲监之。宾等依何承天法，微加增损，四年二月撰成奏上。高祖下诏曰： 张宾等存心算数，通洽古今，每有陈闻，多所启沃。毕功表奏，具已披览。使后月复育，不出前晦之宵，前月之余，罕留后朔之旦。减朓就朒，悬殊旧准。月行表里，厥途乃异，日交弗食，由循阳道。验时转算，不越纤毫，逖德前修，斯秘未启。有一于此，实为精密，宜颁天下，依法施用。 
张宾所造历法，其要：
以上元甲子已来，至开皇四年岁在甲辰，积四百一十二万九千一，算上。
蔀法，一十万二千九百六十。
章岁，四百二十九。
章月，五千三百六。
通月，五百三十七万二千二百九。
日法，一十八万一千九百二十。
斗分，二万五千六十三。
会月，一千二百九十七。
会率，二百二十一。
会数，一百一十半。
会分，一十一亿八千七百二十五万八千一百八十九。
会日法，四千二十万四千三百二十。
会日，百七十三。
余，五万六千一百四十三。
小分，一百一十。
交法，五亿一千二百一十万四千八百。
交分法，二千八百一十五。
阴阳历，一十三。
余，十一万二百六十三。
小分，二千三百二十八。
朔差，二。
余，五万七千九百二十一。
小分，九百七十四。
蚀限，一十二。
余，八万一千三百三。
小分，四百三十三半。
定差，四万四千五百四十八。
周日，二十七。
余，一十万八百五十九。亦名少大法
木精曰岁星，合率四千一百六万三千八百八十九。
火精曰荧惑，合率八千二十九万七千九百二十六。
土精曰镇星，合率三千八百九十二万五千四百一十三。
金精曰太白，合率六千一十一万九千六百五十五。
水精曰辰星，合率一千一百九十三万一千一百二十五。
张宾所创之历既行，刘孝孙与冀州秀才刘焯，并称其失，言学无师法，刻食不中，所驳凡有六条：其一云，何承天不知分闰之有失，而用十九年之七闰。其二云，宾等不解宿度之差改，而冬至之日守常度。其三云，连珠合璧，七曜须同，乃以五星别元。其四云，宾等唯知日气余分恰尽而为立元之法，不知日月不合，不成朔旦冬至。其五云，宾等但守立元定法，不须明有进退。其六云，宾等唯识转加大余二十九以为朔，不解取日月合会准以为定。此六事微妙，历数大纲，圣贤之通术，而晖未晓此，实管窥之谓也。若乃验影定气，何氏所优，宾等推测，去之弥远。合朔顺天，何氏所劣，宾等依据，循彼迷踪。盖是失其菁华，得其糠粃者也。又云，魏明帝时，有尚书郎杨伟，修《景初历》，乃上表立义，驳难前非，云： 加时后天，食不在朔。 然观杨伟之意，故以食朔为真，未能详之而制其法。至宋元嘉中，何承天著历，其上表云： 月行不定，或有迟疾，合朔月食，不在朔望，亦非历之意也。 然承天本意，欲立合朔之术，遭皮延宗饰非致难，故事不得行。至后魏献帝时，有龙宜弟复修延兴之历，又上表云： 日食不在朔，而习之不废，据《春秋》书食，乃天之验朔也。 此三人者，前代善历，皆有其意，未正其书。但历数所重，唯在朔气。朔为朝会之首，气为生长之端，朔有告饩之文，气有郊迎之典，故孔子命历而定朔旦冬至，以为将来之范。今孝孙历法，并按明文，以月行迟疾定其合朔，欲今食必在朔，不在晦、二之日也。纵使频月一小、三大，得天之统。大抵其法有三，今列之云。
第一，勘日食证恆在朔。
引《诗》云： 十月之交，朔日辛卯，日有食之。 今以甲子元历术推算，符合不差。《春秋经》书日食三十五。二十七日食，经书有朔，推与甲子元历不差。八食，经书并无朔字。《左氏传》云： 不书朔，官失之也。 《公羊传》云： 不言朔者，食二日也。 《谷梁传》云： 不言朔者，食晦也。 今以甲子元历推算，俱是朔日。丘明受经夫子，于理尤详，《公羊》、《谷梁》皆臆说也。
《春秋左氏》隐公三年二月己巳，日有食之。推合己巳朔
庄公十八年春三月，日有食之。推合壬子朔
僖公十二年三月庚午，日有食之。推合庚午朔
十五年夏五月，日有食之。推合癸未朔
襄公十五年秋八月丁巳，日有食之。推合丁巳朔
前、后汉及魏、晋四代所记日食，朔、晦及先晦，都合一百八十一，今以甲子元历术推之，并合朔日而食。
前汉合有四十五食。三食并先晦一日，三十二食并皆晦日，十食并是朔日
后汉合有七十四食。三十七食并皆晦日，三十七食并皆朔日
魏合有十四食。四食并皆晦日，十食并皆朔日
晋合有四十八食。二十五食并皆晦日，二十三食并皆朔日
第二，勘度差变验。
《尚书》云： 日短星昴，以正仲冬。 即是唐尧之时，冬至之日，日在危宿，合昏之时，昴正午。案《竹书纪年》，尧元年丙子。今以甲子元历术推算得合尧时冬至之日，合昏之时，昴星正午。《汉书》武帝太初元年丁丑岁，落下闳等考定太初历冬至之日，日在牵牛初。今以甲子元历术算，即得斗末牛初矣。晋时有姜岌，又以月食验于日度，知冬至之日日在斗十七度。宋文帝元嘉十年癸酉岁，何承天考验乾度，亦知冬至之日日在斗十七度。虽言冬至后上三日，前后通融，只合在斗十七度。但尧年汉日，所在既殊，唯晋及宋，所在未改，故知其度，理有变差。至今大隋甲辰之岁，考定历数象，以稽天道，知冬至之日日在斗十三度。
第三，勘气影长验。
《春秋纬命历序》云： 鲁僖公五年正月壬子朔旦冬至。 今以甲子元历术推算，得合不差。《宋书》元嘉十年，何承天以土圭测影，知冬至已差三日。诏使付外考验，起元嘉十三年为始，毕元嘉二十年，八年之中，冬至之日恆与影长之日差校三日。今以甲子元历术推算，但是冬至之日恆与影长之符合不差。详之如左：
十三年丙子，
天正十八日历注冬至，
十五日影长，
即是今历冬至日。
十四年丁丑，
天正二十九日历注冬至，
二十六日影长，
即是今历冬至日。
十五年戊寅，
天正十一日历注冬至，
阴，无影可验，
今历八日冬至。
十六年己卯，
天正二十一日历注冬至，
十八日影长，
即是今历冬至日。
十七年庚辰，
天正二日历注冬至，
十月二十九日影长，
即是今历冬至日。
十八年辛巳，
天正十三日历注冬至，
十日影长，
即是今历冬至日。
十九年壬午，
天正二十九日历注冬至，
阴，无影可验，
今历二十二日冬至。
二十年癸未，
天正六日历注冬至，
三日影长，
即是今历冬至日。
于时新历初颁，宾有宠于高祖，刘晖附会之，被升为太史令。二人协议，共短孝孙，言其非毁天历，率意迂怪，焯又妄相扶证，惑乱时人。孝孙、焯等，竟以他事斥罢。后宾死，孝孙为掖县丞，委官入京，又上，前后为刘晖所诘，事寝不行。仍留孝孙直太史，累年不调，寓宿观台。乃抱其书，弟子舆榇，来诣阙下，伏而恸哭。执法拘以奏之，高祖异焉，以问国子祭酒何妥。妥言其善，即日擢授大都督，遣与宾历比校短长。先是信都人张胄玄，以算术直太史，久未知名。至是与孝孙共短宾历，异论锋起，久之不定。至十四年七月，上令参问日食事。杨素等奏： 太史凡奏日食二十有五，唯一晦三朔，依克而食，尚不得其时，又不知所起，他皆无验。胄玄所克，前后妙衷，时起分数，合如符契。孝孙所克，验亦过半。 于是高祖引孝孙、胄玄等，亲自劳徠。孝孙因请先斩刘晖，乃可定历。高祖不怿，又罢之。俄而孝孙卒，杨素、牛弘等伤惜之，又荐胄玄。上召见之，胄玄因言日长影短之事，高祖大悦，赏赐甚厚，令与参定新术。刘焯闻胄玄进用，又增损孝孙历法，更名《七曜新术》，以奏之。与胄玄之法，颇相乖爽，袁充与胄玄害之。焯又罢。至十七年，胄玄历成，奏之。上付杨素等校其短长。刘晖与国子助教王頍等执旧历术，迭相驳难，与司历刘宜援据古史影等，驳胄玄云：
《命历序》僖公五年天正壬子朔旦日至，《左氏传》僖公五年正月辛亥朔日南至。张宾历，天正壬子朔冬至，合《命历序》，差《传》一日。张胄玄历，天正壬子朔，合《命历序》，差《传》一日；三日甲寅冬至，差《命历序》二日，差《传》三日。成公十二年，《命历序》天正辛卯朔旦日至。张宾历，天正辛卯朔冬至，合《命历序》。张胄玄历，天正辛卯朔，合《命历序》；二日壬辰冬至，差《命历序》一日。昭公二十年，《春秋左氏传》二月己丑朔日南至，准《命历序》庚寅朔旦日至。张宾历，天正庚寅朔冬至，并合《命历序》，差《传》一日。张胄玄历，天正庚寅朔，合《命历序》，差《传》一日；二日辛卯冬至，差《命历序》一日，差《传》二日。宜案《命历序》及《春秋左氏传》，并闰余尽之岁，皆须朔旦冬至。若依《命历序》勘《春秋》三十七食，合处至多；若依《左传》，合者至少，是以知《传》为错。今张胄玄信情置闰，《命历序》及《传》气朔并差。又宋元嘉冬至影有七，张宾历合者五，差者二，亦在前一日。张胄玄历合者三，差者四，在后一日。元嘉十二年十一月甲寅朔，十五日戊辰冬至，日影长。张宾历合戊辰冬至，张胄玄历己巳冬至，差后一日。十三年十一月己酉朔，二十六日甲戌冬至，日影长。张宾历癸酉冬至，差前一日，张胄玄历合甲戌冬至。十五年十一月丁卯朔，十八日甲申冬至，日影长。二历并合甲申冬至。十六年十一月辛酉朔，二十九日己丑冬至，日影长。张宾历合己丑冬至，张胄玄历庚寅冬至，差后一日。十七年十一月乙酉朔，十日甲午冬至，日影长。张宾历合甲午冬至，张胄玄历乙未冬至，差后一日。十八年十一月己卯朔，二十一日己亥冬至，日影长。张宾历合己亥冬至，张胄玄历庚子冬至，差后一日。十九年十一月癸卯朔，三日乙巳冬至，影长。张宾历甲辰冬至，差前一日，张胄玄历合乙巳冬至。
又周从天和元年丙戌至开皇十五年乙卯，合得冬夏至日影一十四。张宾历合得者十，差者四，三差前一日，一差后一日。张胄玄历合者五，差者九，八差后一日，一差前一日。天和二年十一月戊戌朔，三日庚子冬至，日影长。张宾历合庚子冬至，张胄玄历辛丑冬至，差后一日。三年十一月壬辰朔，十四日乙巳冬至，日影长。张宾历合乙巳冬至，张胄玄历丙午冬至，差后一日。建德元年十一月己亥朔，二十九日丁卯冬至，日影长。张宾历丙寅冬至，差前一日，张胄玄历合丁卯冬至。二年五月丙寅朔，三日戊辰夏至，日影短。张宾历己巳夏至，差后一日，张胄玄历庚午夏至，差后二日。三年十一月戊午朔，二十日丁丑冬至，日影长。张宾历合丁丑冬至，张胄玄历戊寅冬至，差后一日。六年十一月庚午朔，二十三日壬辰冬至，日影长。张宾历合壬辰冬至，张胄玄历癸巳冬至，差后一日。宣政元年十一月甲午朔，五日戊戌冬至，日影长。两历并合戊戌冬至。开皇四年十一月己未朔，十一日己巳冬至，日影长。张宾历合己巳冬至，张胄玄历庚午冬至，差后一日。五年十一月甲寅朔，二十二日乙亥冬至，日影长。张宾历甲戌冬至，差前一日，张胄玄历合庚辰冬至。七年五月乙亥朔，九日癸未夏至，日影短。张宾历壬午夏至，差前一日，张胄玄历合癸未夏至。十一月壬申朔，十四日乙酉冬至，日影长。张宾历合乙酉冬至，张胄玄历丙戌冬至，差后一日。十一年十一月己卯朔，二十八日丙午冬至，日影长。张宾历合丙午冬至，张胄玄历丁未冬至，差后一日。十四年十一月辛酉朔旦冬至。张宾历合十一月辛酉朔旦冬至，张胄玄历十一月辛酉朔，二日壬戌冬至，差后一日。建德四年四月大、乙酉朔，三十日甲寅，月晨见东方。张宾历四月大、乙酉朔，三十日甲寅，月晨见东方，张胄玄历四月小、乙酉朔，五月大，甲寅朔，月晨见东方。宜案影极长为冬至，影极短为夏至，二至自古史分可勘者二十四，其二十一有影，三有至日无影。见行历合一十八，差者六。旅骑尉张胄玄历合者八，差者一十六，二差后二日，一十四差后一日。又开皇四年，在洛州测冬至影，与京师二处，进退丝毫不差。周天和已来案验并在后。更检得建德四年，晦朔东见；张胄玄历，五月朔日，月晨见东方。今十七年，张宾历闰七月，张胄玄历闰五月。又审至以定闰，胄玄历至既不当，故知置闰必乖。见行历四月、五月频大，张胄玄历九月、十月频大，为胄玄朔弱，频大在后晨，故朔日残月晨见东方。
宜又案开皇四年十二月十五日癸卯，依历月行在鬼三度，时加酉，月在卯上，食十五分之九，亏起西北。今伺候，一更一筹起食东北角，十五分之十，至四筹还生，至二更一筹复满。五年六月三十日，依历太阳亏，日在七星六度，加时在午少强上，食十五分之一半强，亏起西南角。今伺候，日乃在午后六刻上始食，亏起西北角，十五分之六，至未后一刻还生，至五刻复满。六年六月十五日，依历太阴亏，加时酉，在卯上，食十五分之九半弱，亏起西南，当其时阴云不见月。至辰巳，云里见月，已食三分之二，亏从东北，既还云合。至巳午间稍生，至午后，云里暂见，已复满。十月三十日丁丑，依历太阳亏，日在斗九度，时加在辰少弱上，食十五分之九强，亏起东北角。今候所见，日出山一丈，辰二刻始食，亏起正西，食三分之二，辰后二刻始生，入巳时三刻上复满。十年三月十六日癸卯，依历月行在氐七度，时加戌，月在辰太半上，食十五分之七半强，亏起东北。今候，月初出卯南，带半食，出至辰初三分，可食二分许，渐生，辰未已复满。见行历九月十六日庚子，月行在胃四度，时加丑，月在未半强上，食十分之三半强，亏起正东。今伺候，月以午后二刻，食起正东，须臾如南，至未正上，食南畔五分之四，渐生，入申一刻半复满。十二年七月十五日己未，依历月行在室七度，时加戌，月在辰太强上，食十五分之十二半弱，亏起西北。今伺候，一更三筹起西北上，食准三分之二强，与历注同。十三年七月十六日，依历月在申半强上，食十五分之半弱，亏起西南。十五日夜，从四更候月，五更一筹起东北上，食半强，入云不见。十四年七月一日，依历时加巳弱上，食十五分之十二半强。至未后三刻，日乃食，亏起西北，食半许，入云不见，食顷暂见，犹未复生，因即云鄣。十五年十一月十六日庚午，依历月行在井十七度，时加亥，月在巳半上，食十五分之九半强，亏西北。其夜一更四筹后，月在辰上起食，亏东南，至二更三筹，月在巳上，食三分之二许，渐生，至三更一筹，月在丙上，复满。十六年十一月十六日乙丑，依历月行在井十七度，时加丑，月在未太弱上，食十五分之十二半弱，亏起东南。十五日夜伺候，至三更一筹，月在丙上，云里见，已食十五分之三许，亏起正东，至丁上，食既，后从东南生，至四更三筹，月在未末，复满。而胄玄不能尽中。
迭相驳难，高祖惑焉，逾时不决。会通事舍人颜慜楚上书云： 汉落下闳改《颛顼历》作《太初历》，云后八百岁，此历差一日。 语在胄玄传。高祖欲神其事，遂下诏曰： 朕应运受图，君临万宇，思欲兴复圣教，恢弘令典，上顺天道，下授人时，搜扬海内，广延术士。旅骑尉张胄玄，理思沉敏，术艺宏深，怀道白首，来上历法。令与太史旧历，并加勘审。仰观玄象，参验璇玑，胄玄历数与七曜符合，太史所行，乃多疏舛，群官博议，咸以胄玄为密。太史令刘晖，司历郭翟、刘宜，骁骑尉任悦，往经修造，致此乖谬。通直散骑常侍、领太史令庾季才，太史丞邢俊，司历郭远，历博士苏粲，历助教傅俊、成珍等，既是职司，须审疏密。遂虚行此历，无所发明。论晖等情状，已合科罪，方共饰非护短，不从正法。季才等附下罔上，义实难容。 于是晖等四人，元造诈者，并除名；季才等六人，容隐奸慝，俱解见任。胄玄所造历法，付有司施行。擢拜胄玄为员外散骑侍郎，领太史令。胄玄进袁充，互相引重，各擅一能，更为延誉。胄玄言充历妙极前贤，充言胄玄历术冠于今古。胄玄学祖冲之，兼传其师法。自兹厥后，克食颇中。其开皇十七年所行历术，命冬至起虚五度。后稍觉其疏，至大业四年刘焯卒后，乃敢改法，命起虚七度，诸法率更有增损，朔终义宁。今录戊辰年所定历术著之于此云。
自甲子元至大业四年戊辰，百四十二万七千六百四十四年，算外。
章岁，四百一十。
章闰，百五十一。
章月，五千七十一。
日法，千一百四十四。
月法，三万三千七百八十三。
辰法，二百八十六。
岁分，一千五百五十七万二千九百六十三。
度法，四万二千六百四十。
没分，五百一十九万一千三百一十一
没法，七万四千五百二十一。
周天分，一千五百五十七万四千四百六十六。
斗分，一万八百六十六。
气法，四十六万九千四十。
气时法，一万六百六十。
周日，二十七。
日余，一千四百一十三。
周通，七万二百九。
周法，二千五百四十八。
推积月术：
置入元已来至所求年，以章月乘之，如章岁得一，为积月，余为闰余。闰余三百九十七巳上，若冬至不在其月，加积月一
推月朔弦望术：
以月法乘积月，如法得一，为积日，余为小余。以六十去积日，余为大余，命以甲子算外，为所求年天正月朔日。天正月者，建子月也，今为去年十一月。凡朔小余五百四十七巳上，其月大。
加大余七，小余四百三十七太；凡四分一为少，二为半，三为太。小余满日法去之，从大余；满六十去之，命如前，为上弦日。又加，得望、下弦、后月朔。朔余满五百三十七，其月大，减者小余。
推二十四气术：
以月法乘闰余，又以章岁乘朔小余，加之，如气法得一，为日，命朔算外，为冬至日。不尽者，以十一约之，为日分。
求次气：加日十五，日分九千三百一十五，小分一；小分满八从日分一，日分满度法从日一；如月大小去之，日不满月，算外，为次气日。其月无中气者，为闰。
求朔望入气盈缩术：
以入气日算乘损益率，如十五得一，余八已上，从一；以损益盈缩数为定盈缩。其入气日十五算者，如十六得一，余半法已上亦从一，以下皆准此。
推土王术：
加分至日二十七，日分一万六千七百六十七，小分九；小分满四十从日分一，满去如前，即分至后土始王日。
推没日术：
其气有小分者，以八乘日分，内小分，又以十五乘之，以减没分；无小分者，以百二十乘日分，以减之；满没法为日，不尽为日分，以其气去朔日加之，去、命如前。
求次没：加日六十九，日分四万九千三百七十二；日分满没法，从日，去、命如前。
推入迟疾历术：
以周通去朔积日，余以周法乘之，满周通又去之，余满周法得一日，余为日余，即所求年天正朔算外夜半入历日及余。
求次月：大月加二日，小月加一日，日余皆千一百三十五，满周日及日余去之。
求次日：加一，满、去如前。
求朔望加时入历术：
以四十九乘朔小余，满二十二得一为日余，不尽为小分，以加夜半入历日及余分。
求次月：加日一，余二千四百八十六，小分二十一，满、去如前，即次月入历日及余。
求望：加日十四日，余千九百四十九，小分二十一半，满、去如前，为望入历日及余。
推朔望加时定日及小余术：
以入历日余乘所入历日损益率，以损益盈缩积分，如差法而一，为定积分。如差法乃与入气定盈缩，皆以盈减、缩加本朔望小余；不足减者，加日法乃减之，加时在往日；加之，满日法者去之，则在来日；余为定小余。无食者不须气盈缩。
角十二度亢九度氐十五度房五度心五度尾十八度箕十一度
东方七宿七十五度
斗二十六度牛八度女十二度虚十度危十七度室十六度壁九度
北方七宿九十八度
奎十六度娄十二度胃十四度昴十一度毕十六度觜二度参九度
西方七宿八十度
井三十三度鬼四度柳十五度星七度张十八度翼十八度轸十七度
南方七宿百一十二度
推日度术：
置入元至所求年，以岁分乘之，为通实，满周天分去之，余如度法而一，为积度，不尽为度分。命度以虚七度宿次去之，经斗去其分，度不满宿，算外，即所求年天正冬至日所在度及分。以冬至去朔日以减分度数，分不足减者，减度一，加度法，乃减之，命如前，即天正朔前夜半日所在度及分。须求朔共度者，用去定用日数减之，俟后所须。
求次月：大月加度三十，小月加度二十九，宿次去之，经斗去其分。
求次日：加度一，去、命如前。
求朔望加时日所在度术：
各以定小余乘章岁，满十一为度分，以加其前夜半度分，满之去如前。凡朔加时日月同度
求转分：以千四十约度分，不尽为小分。
求望加时月所在度术：
置望加时日所在度及分，加度一百八十二，转分二十五，小分七百五十三；小分满千四十从转分一，转分满四十一从度；去、命如前，经斗去转分十，小分四百六十六。
求月行迟疾日转定分术：
以夜半入历日余乘转差，满周法得一为变差，以进加、退减日转分为定分。
推朔望夜半月定度术：
以定小余乘所入历日转定分，满日法得一为分，分满四十一为度，各以减加时月所在度，即各其前夜半定度。
求次日：以日转定分加转分，满四十一从度，去、命如前；朔日不用前加。
推五星术：
木数，千七百万八千三百三十二四分
火数，三千三百二十五万六千二十六。
土数，千六百一十二万一千七百六十七。
金数，二千四百八十九万八千四百一十七。
水数，四百九十四万一千九十八。
木终日，三百九十八，日分，三万七千六百一十二四分。
火终日，七百七十九，日分，三万九千四百六十六。
土终日，三百七十八，日分，三千八百四十七。
金终日，五百八十三，日分，三万九千二百九十七。晨见伏，三百二十七日，分同；夕见伏，二百五十六日。
水终日，百一十五，日分，三万七千四百九十八。晨见伏，六十三日，分同；夕见伏，五十二日。
求星见术：
置通实，各以数去之，余以减数，其余如度法得一为日，不尽为日分，即所求年天正冬至后晨平见日及分。其金、水，以夕见伏日去之，得者余为夕平见日及分。
求平见见月日：置冬至去朔日数及分，各以冬至后日数及分加之，分满度法从日，起天正月，依大小去之，不满月者为去朔日，命日算外，即星见所在月日及分。
求后见：各以终日及分加之，满去如前。其金、水各以晨夕加之，满去如前，加晨得夕，加夕得晨。
木：平见在春分前者，以三千三百四十乘去大寒后十日数，以加平见分，满法去之，以为定见日及分。立秋后者，以四千二百乘去寒露日，加之，满同前。春分至清明均加四日，后至立夏五日，以后至芒种加六日，均至立秋。小雪前者，以七千四百乘去寒露日数，以减平见日分；冬至后者，以八千三百乘去大寒后十日数，以减之；小雪至冬至均减八日，为定日数。初见伏去日各十四度。
火：平见在雨水前，以二万六千八百八十乘去大寒日数；在立夏后，以万三千四百四十乘去立秋日数，以加见日分，满去如前；雨水至立夏，均加二十九日。小雪前，以万一千五百八十乘去处暑日数；冬至后，以三万四千三百八十乘去大寒日数，满去如前，以减之；小雪至冬至，均减二十五日。初见伏去日各十七度。
土：平见在处暑前，以万二千三百七十乘去大暑日数；白露后，以八千三百四十乘去霜降日数，以加见日分，满去如前；处暑至白露均加九日。小寒前，以四千九百八十乘去霜降日数，小寒至立春均减九日，立春后减八日，启蛰后去七，气别去一，至谷雨去三，夏至后十日去一，至大暑去尽。初见伏去日各十七度。
金：晨平见，在立春前者，以四千一百二十乘去小寒日数小满后，以四千一百二十乘去夏至日数，以加见日分，满去如前立春至小满均加三日。立秋前，以四千一百二十乘去小暑日数，小雪后以四千一百二十乘去冬至日数，满去如前，以减之，立秋至小雪均减三日。夕平见，在启蛰前，以六千三百九十乘去小雪日数。清明后，以六千二百九十乘去芒种日数，满去如前，以减之，启蛰至清明均减九日。处暑前，以六千二百九十乘去夏至日数；寒露后，以六千二百九十乘去大雪日数；以加之，处暑至寒露均加九日。初见伏去日各十一度。
水：晨平见，在雨水后、立夏前者，应见不见。启蛰至雨水，去日十八度外、四十六度内，晨有木、火、土、金一星已上者，见；无者不见。立夏至小满，去日度如前，晨有木、火、土、金一星已上者，见；无者亦不见。从霜降至小雪加一日，冬至至小寒减四日，立春至雨水减三日。冬至前，一去三，二去二，三去一。夕平见，在处暑后、霜降前者，应见不见。立秋至处暑，夕有星，去日如前者，见；无者亦不见。霜降至立冬，夕有星，去日如前者，见；无者亦不见。从谷雨至夏至，减二日。初见伏去日各十七度。
行五星法：
置星定见之前夜半日所在宿度算及分，各以定见日分加其分，满度法从度。又以星初见去日度数，晨减、夕加之，满去如前，即星初见所在度及分。
求次日：各加一日所行度及分，有小分者，各日数为母，小分满其母去从分，分满度法从度。其行有益疾迟者，副置一日行分，各以其分疾益迟损之。留者因前，退则减之，伏不注度，顺行出斗去其分，退行入斗先加分。讫，皆以千四十约分，为大分，以四十一为母。
木：初见，顺，日行万六百一十八分，日益迟六十分，一百一十四日行十九度、万三千八百三十二分而留。二十六日乃退，日六千一百一分，八十四日退十二度、八百四分。又留二十五日、三万七千六百一十二分、小分四，乃顺。初日行三千八百三十七分，日益疾六十分，百一十四日行十九度、万三千七百一十八分而伏。
土：初见，顺，日行三千八百一十四分，八十三日行七度、万八千八十二分而留。三十八日乃退，日二千五百六十三分，百日退六度、四百六十分。又留三十七日、三千八百四十七分乃顺，日三千八百一十三分，八十三日行七度万七千九百九十九分，如初乃伏。
火：初见已后各如其法：
见在雨水前，以见去小寒日数，小满后，以去大暑日数；三约之，所得减日为定日；雨水至小满，均去二十日为定日。已前皆前疾日数及度数。各计冬至后日数，依损益之，为定日数及度数。以度法乘定度，如定日得一，即平行一日分，不尽为小分。大寒至立秋差行，余平行。处暑至白露，皆去定日，定度六。白露至寒露，初日行半度，四十日行二十度，余日及余度续同前。置日数减一，以三十乘之，加平行一日分，为初日分。差行者，日益迟六十分，各尽其日度而迟。初日行二万六百分，日益迟百分，六十日行二十四度、三万五千六百四十分其前疾去度六者，此迟初日加四千二百六十四分，六十日行三十度，分同。而留。十三日前去日者，分、日于二留，奇纵后留。乃退，日万二千八十二分，六十日退十七度、四十分。又留，十二日三万九千四百六十六分。又顺，迟，初日行万四千七百分，日益疾百分，六十日行二十四度，分同前，此迟在立秋至秋分加一日，行分四千二百六十四，六十日行四十度，分同前。而后疾。
后迟加六度者，此后疾去度为定度，已前皆后疾日数及度数。其在立夏至，小暑，日行半度，尽六十日，行三十度。小暑至立秋，尽四十日，行二十度。计余日及度，从前法。前法皆平行。求行分亦如前。各尽其日度而伏。
金：晨初见，乃退，日半度，十日退五度而留。九日乃顺，迟，差行，先迟日益五百分，四十日行三十度。小暑前以去芒种日数，十日减一度；立冬后以去大雪日数，十日减一度；小暑至立冬，均减三度为定度。大雪至芒种不加减。求初日，以三十乘度法，四十得一为平分。又以三十九乘二百五十，以减平分为初日行分。平行，日一度，十五日行十五度。小寒后十日，益日度各一，至雨水二十一日，行二十一度。均至春分后十日减一，至小满，复十五日行十五度。其后六日减一，至处暑，日及度皆尽。至霜降后，四日益一，至冬至复十五日行十五度疾，百七十日行二百四度。前顺迟减度者，计减数益此度为定度。求一日行度分者，以百七十日日一度以减定度，余乘度法，如百七十得一，为一日平行度分。晨伏东方。夕初见，顺，疾，百七十日行二百四度。夏至前，以见去小满日数，六日加一度；小暑后，以去立秋日数，六日加一度，夏至至小暑均加五度，为定度。白露至清明，差行，先疾日益迟百分。清明至白露，平行，求一日平行同，晨疾求差行，以五十乘百六十九，加之，为初日行度分。平行，日一度，十五日行十五度。冬至后十日减日度各一，至启蛰九日行九度。均至夏至后五日益一，至大暑复十五日行十五度。均至立秋后六日益一，至寒露二十五日行二十五度。后六日减一，至大雪复十五日行十五度，均至冬至。顺，迟，差行，先疾，日益五百分，四十日行三十度。前加度者，此依数减之，求初日行分。如晨迟，唯减者为加之。又留，九日乃退，日半度，十日退五度，而夕伏西方。
水：晨初见，留六日。顺，迟，日行万六百六十分，四日行一度。大寒至雨水不须此迟行。平行，日一度，十日行十度。大寒后二日，去日度各一，尽二十日，日及度俱尽。疾，日行一度三万八千三百七十六分，十日行十九度，前无迟行者，减此分万二千七百九十二分，十日行十六度。晨伏东方。夕初见，顺，疾，日行一度三万八千三百七十六分，十日行十九度。小暑至白露减万二千七百九十二分，十日行十六度。平行，日一度，十日行十度。大暑后二日，去日度各一，尽二十日，日及度俱尽。迟，日行万六百六十分，四日行一度。疾减万二千七百九十二分者，不须此迟。行又留六日，夕伏西方。
推交会术：
会通，千六十四万六千七百二十九。
朔差，九十万七千五十七。
望差，四十五万三千五百二十八半。
单数，五百三十二万三千三百六十四半。
时法，三万二千六百四。
望数，五百七十七万六千八百九十三。
外限，四百八十六万九千八百三十六。
内限，千一十九万三千二百半。
中限，五百六十四万九千四百四半。
次限，千三十二万六百八十九。
推入交法：
以会通去积月，余以朔望差乘之，满会通又去之，余为所求年天正朔入交余。
求望，望数加之，满、去如前。
求次月，以朔差加之，满、去如前。
推交道内外及先后去交术：
其朔望在启蛰前，以一千三百八十乘去小寒日数；在谷雨后，以乘去芒种日数，为气差以加之，启蛰至谷雨均加六万三千六百；满会通去之，余为定余。其小寒至春分，立夏至芒种，朔值盈二时已下，皆半气差而加之；二时已上，皆不加。朔入交余如望差、望数已下，中限已上，有星伏，木、土去见十日外，火去见四十日外，金、晨伏去见二十二日外。有一星者不加气差。朔望在白露前者，以九百乘去小暑日数；在立冬后者，以千七百七十乘去大雪日数，以减之；白露至立冬均减五万五千，不足减者，加会通乃减之，余为定余。朔入交余如外限、内限已上，单数次限已下有星伏，如前者，不减气差。定余不满单数者，为在外；满去之，余在内。其余如望差已下、外限已上，望则月食；在内者，朔则日食。其余如望差已下者，即为去先交余；如外限已上者，以减单数，余为去后交余。如时法得一，然为去交时数。
推月食加时术：
置食定日小余，三之，如辰法得一辰，命以子算外，即所在辰。不尽为时余，四之，如法，无所得为辰初，一为少，二为半，三为太。又不尽者，三之，如法，得一为强，以并少为少强，并半为半强，并太为太强；得二强者为少弱，并少为半弱，并半为太弱，并太为辰末。此加时谓食时月在冲也。
推日食加时术：
置食定日小余，秋三月，内道，去交八时已上，加二十四，十二时以加四十八；春三月，内道，去交七时已上，加二十四。乃以三乘之，如辰法得一辰，以命子算外，即所在辰。不尽为时余。副置时余，仲辰不满半辰，减半辰，已上去半辰；季辰者直加半辰；孟辰者减辰法，余加半辰为差率。
又，置去交时数，三已下加三，六已下加二，九已下加一，九已上依数，十二已上从十二；以乘差率，如十四得一为时差。子半至卯半、午半至酉半，以加时余；卯半至午半、酉半至子半，以减时余。加之，满辰法去之，进一辰，减之若不足，退一辰，余为定时余。乃如月食法，子午卯酉为仲，辰戌丑未为季，寅申巳亥为孟。日出前入后各二时外，不注日食。三乘气时法得一，命子算外为时。
求外道日食法：
去交一时内者，食。夏去交二时内，加时在南方三辰者，食。若去分至十二时内，去交六时内者，亦食。若去春分三日内，后交二时内，秋分三日内，先交二时内者，亦食。先交二时内，值盈二时外，及后交二时内，值缩二时外，亦食。诸去交三时内，星伏如前者，食。
求内道日不食法：
加时南方三辰，五月朔先交十三时外，六月朔后交十三时外，不食。启蛰至谷雨，先交十三时外，值缩加时在未以西者，不食。处暑至霜降，后交十三时外，值盈加时在巳以东者，不食。
求月食分：
春后交、秋先交、冬后交，皆去不食余一时，不足去者，食既。余以三万二百三十五为法，得一为不食分。不尽者，半法已上为半强，已下为半弱，以减十五，余为食分。
推日食分术：
在秋分前者，以去夏至日数乘二千，以减去交余，余为不食余；不足减者，反减十八万四千，余为不食余。亦减望差为定法。其后交值缩，并不减望差，直以望差为定法。在启蛰后者，以去夏至日数乘千五百以减之；秋分至启蛰，均减十八万四千，不足减者，如前；大寒至小满，去后交五时外，皆去不食余一时。时差减者，先交减之，后交加之，不足减者食既；值加，先交加之，后交减之。不足减者食。
求所起：内道西北，亏东北；外道西南，亏东南。十三分以上，正左起。亏皆据甚时，月则行上起。
求日出入所在术：
以所入气辰刻及分，与后气辰刻及分相减，余乘入气日算，如十五得一，以损益所入气，依刻及分为定刻。

◎历五
大统历法三上(推步)
大统推步，悉本《授时》，惟去消长而已。然《通轨》诸捷法，实为布算所须，其间次序，亦有与《历经》微别者。如气朔发敛，《授时》原分二章，今古合为一。《授时》盈缩差在日躔，迟疾差在月离，定朔、经朔离为二处。今则经朔后，即求定朔，于用殊便。其目七：曰气朔，曰日躔，曰月离，曰中星，曰交食，曰五星，曰四余。
▲步气朔(发敛附)
洪武十七年甲子岁为元。(上距至元辛巳一百零四算。)
岁周三百六十五万二千四百二十五分，实测无消长。半之为岁周，四分之为气象限，二十四分之为气策。
日周一万。(即一百刻，刻有百分，分有百秒，以下微纤，皆以百递析。)
气应五十五万零三百七十五分。
置距算一百零四，求得中积三亿七千六百一十九万九千七百七十五分，加辛巳气应五十五万零六百分，得通积三亿七千六百七十五万零三百七十五分，满纪法六十去之，余为《大统》气应。
开应一十八万二千零百七十零分一十八秒。
置中积，加辛巳闰应二十零万二千零五十分，得闰积三亿七千六百四十零万一千八百二十五分，满朔实去之，余为《大统》闰应。
转应二十零万九千六百九十零分。
置中积，加辛巳转应一十三万零二百零五分，共得三亿七千六百三十二万九千九百八十分，满转终去之，余为《大统》转应。
交应一十一万五千一百零五分零八秒。
置中积加辛巳交应二十六万零三百八十八分，共得三亿七千六百四十六万零一百六十三分，满交终去之，余为《大统》交应。
按《授时历》既成之后，闰转交三应数，旋有改定，故《元志》、《历经》闰应二十零万一千八百五十分，而《通轨》载闰应二十零万二千零五十分，实加二百分，是当时经朔改早二刻也。《历经》转应一十三万一千九百零四分，《通轨》载转应一十三万零二百零五分，实减一千六百九十九分，是入转改迟一十七刻弱也。《历经》交应二十六万零一百八十七分八十六秒，《通轨》交应二十六万零三百八十八分，实加二百分一十四秒，是正交改早二刻强也。或以《通轨》辛巳三应，与《元志》互异，目为元统所定，非也。夫改宪必由测验，即当具详始末，何反追改《授时历》，自没其勤乎？是故《通轨》所述者，乃《授时》续定之数，而《历经》所存，则其未定之初藁也。
通余五万二千四百二十五分。
朔策二十九万五千三百零五分九十三秒，一名朔宝。半之为望策，一名交望。又半之为弦策。
通闰一十零万八千七百五十三分八十四秒。
月闰九千零百六十二分八十二秒。
闰限一十八万六千五百五十二分零九秒。一名闰准。
盈初缩末限八十八万九千零百九十二分二十五秒。
缩初盈末限九十三万七千一百二十零分二十五秒。
转终二十七万五千五百四十六分，半之为转中。
朔转差一万九千七百五十九分九十三秒。
日转限一十二限二十。
转中限一百六十八限零八三零六零。以日转限乘转中。一名限总。
朔转限二十四限一零七一一四六。以日转限乘朔转差。
弦转限九十零限零六八三零八六五。以日转限乘弦策。一名限策。
交终二十七万二千一百二十二分二十四秒。
朔交差二万三千一百八十三分六十九秒。
气盈二千一百八十四分三十七秒五十微。
朔虚四千六百九十四分零七秒。
没限七千八百一十五分六十二秒五十微。
盈策九万六千六百九十五分二十八秒。
虚策二万九千一百零四分二十二秒。
土王策三万零四百三十六分八十七秒五十微。
宿策一万五千三百零五分九十三秒。
纪法六十万。(即旬周六十日。)
推天正冬至置距洪武甲子积年减一，以岁周乘之为中积，加气应为通积，满纪法去之，至不满之数，为天正冬至。以万为日，命甲子算外，为冬至日辰。累加通余，即得次年天正冬至。
推天正闰余置中积，加闰应，满朔策去之，至不满之数，为天正闰余。累加通闰，即得次年天正闰余。
推天正经朔置冬至，减闰余，遇不及减，加纪法减之，为天正经朔。无闰加五十四万三六七一一六。十二朔策纪法。有闰，加二十三万八九七七零九。十三朔实去纪法。满纪法仍去之，即得次年天正经朔视天正闰余在闰限已上，其年有闰月。
推天正盈缩置半岁周，内减其年闰余全分，余为所求天正缩历。如径求次年者，于天正缩历内减通闰，即得。减后，视在一百五十三日零九已下者，复加朔实，为次年天正缩历。
推天正迟疾置中积，加转应，减去其年闰余全分，余满转终去之，即天正入转。视在转中已下为疾历，已上去之为迟历。如径求次年者，加二十三万七一一九一六，十二转差之积。经闰再加转差，皆满转终去之，迟疾各仍其旧。若满转中去之，为迟疾相代。
推天正入交置中积，减闰余，加交应，满交终去之，即天正入交凡日。如径求次年者，加六千零八十二分零四秒，(十二交差内去交终。)经闰加二万九千二百六十五分七十三秒，十三交差内去交终。皆满交终仍去之，即得。
推各月经朔及弦望置天正经朔策，满纪法去之，即得正月经朔。以弦策累加之，去纪法，即得弦望及次朔。
推各恒气置天正冬至，加三气策，满纪法去之，即得立春恒日。以气策累加之，去纪法，即得二十四气恒日。
推闰在何月置朔策，以有闰之年之闰余减之，余为实，以月闰为法而一，得数命起天正次月算外，即得所闰之月。闰有进退，仍以定朔无中气为定。如减余不及月闰，或仅及一月闰者，为闰在年前。
推各月盈缩历置天正缩历，加二朔策，去半岁周，即得正月经朔下盈历。累加弦策，各得弦望及次朔，如满半岁周去之交缩，满半周又去之即复交盈。
推初末限视盈历在盈初缩末限已下，缩历在缩初盈末限已下，各为初。已上用减半岁周为末。
推盈缩差置初末历小余，以立成内所有盈缩加之乘之为实，日周一万为法除之，得娄数以加其下盈缩积，即盈缩差。
推各月迟疾历置天正经朔迟疾历，加二转差，得正月经朔下迟疾历。累加弦策，得弦望及次朔，皆满转中去之，为迟疾相代。
推迟疾限各置迟次历，以日转限乘之，即得限数。以弦转限累加之，满转中限去之，即各弦望及次朔限。如径求次月，以朔转限加之，亦满转中去之，即得。(又法：视立成中日率，有与迟疾历较小布相近者以减之，余在八百二十已下，即所用限。)
求迟疾差置迟疾历，以立成日率减之，(如不及减，则退一位。)余以其下损益分乘之为实，八百二十分为法除之，得数以加其下迟疾积，即迟疾差。
推加减差视经朔弦望下所得盈缩差、迟疾差，以盈遇迟、缩遇疾为同相并，盈遇疾、缩遇迟为异相较，各以八百二十分乘之为实，再以迟疾限行度内减去八百于二十分，为定限度为法，法除实为加减差。盈迟为加，缩疾为减，异名相较者，盈多疾为加，疾多于盈为减，缩多於迟减，迟多於缩加。
推定朔望各置经朔弦望，以加减差加减之，即为定日。视定朔干名，与后朔同者月大，不同者月小，内无中气者为闰月。其弦望在立成相同日日出分已下者，则退一日命之。
推各月入交置天正经朔入交凡日加二交差，得正月经朔下入交凡日。累加交望，满交终去之，即得各月下入交凡日。径求次月，加交差即得。
推土王用事置谷雨、大暑、霜降、大寒恒气日，减土王策，如不及减，加纪法减之，即各得土王用事日。
推发敛加时各置所推定朔弦望及恒气之小余，以十二乘之，满万为时，命起子正。满五千，又进一时，命起子初。算外得时不满者，以一千二百除之为刻，命起初刻。初正时之刻，皆以初一二三四为好，于算外命之。(其第四刻为畸零，得刻法三之一，凡三时成一刻，以足十二时百刻之数。)
按古因及《授时》，皆以发敛为一章。发敛去者，日道发南敛北之细数也，而加时附焉，则又所以纪发敛之辰刻，故曰发敛加时也。《大统》取其便算，故合发敛与气朔共为一章，或以乘除疏发敛，非其质矣。
推盈日视恒气小余，在没限已上，为有盈之气。置策余一万零一四五六二五，以十五日除气策。以有盈之气小余减之，余以六十八分六六以气盈除十五日。乘之，得数以加恒气大余，满纪法去之，命甲子算外，得盈日。求盈日及分秒，以盈策加之，又去纪法，即得。
推虚日视经朔小余在朔虚已下，为有虚之朔。置有虚之朔小余，以六十三分九一以朔虚除三十日。乘之，得数以加经朔大余，满纪法去之，命甲子算外为虚日。求次虚。置日及分秒，以虚策加之，又去纪法，即得。
推直宿置通积，以气应加中积。减闰应，以宿会二十八万累去之，馀命起翼宿算外，得天正经朔直宿。置天正经宿直宿，加两宿策，为正月经朔直宿。以宿策累加，得各月经朔直宿。再以各月朔下加减差加减之，为定朔直宿。
▲步日躔
周天三百六十五度二十五分七十五秒，半之为半周天，又半之为象限。
岁差一分五十秒。
周应三百一十五度一十分七十五秒。
按此系至元辛巳之周应，乃自虚七度至箕十之度数也。洪武甲子相距一百四年，岁差已退天五十四分五十秒，而周应仍用旧数，殆传习之误耳。
推天正冬至日躔赤道宿次置中积，加周应，应减距历元甲子以来岁差。满周天去之，不尽，起虚七度，依各宿次去之，即冬至加时赤道日度。如求次年，累减岁差，即得。
(表格略)
推天正冬至日躔黄道宿次置冬至加时赤道日度，以至后赤道积度减之，余以黄道率乘之。如赤道率而一，得数以加黄道积度，即冬至加时黄道日度。黄赤道积度及度率，俱见《法原》。
推定象限度以冬至加时赤道日度，与冬至加时黄道日度相减，为黄赤道差。以本年黄赤道差，与次年黄赤道相减，余以四而一，加入气象限内，为定象限度。
推四正定气日置所推冬至分，即为冬正定气，加盈初缩末限，满纪法去之，余为人正定气。加缩初盈末限，去纪法，余为秋正定气。加缩初盈末限，去纪法，余为次年冬正定气。
推四正相距日以前正定气大余，减次正定气大余，加六十日，得相距日。如次正气不及减者，加六十日减之，再加六十日，为相距日。
推四正加时黄道积度置冬至加时黄道日度，累加定象限，各得四正加时黄道积度。
推四正加时减分置四正定气小余，以其初日行度乘之，如日周而一，为各正加时减分。
冬正行一度零五一零八五。春正距夏正九十三日者，行零度九九九七零三，距九十四日者行一度。夏正行零度九五一五一六。秋正距冬正八十八日者，行一度零零零五零五，距八十九日者行一度。
推四正夜半积度置四正加时黄道积芭，减去其加时减分，即得。
推四正夜半黄道宿次置四正夜半黄道积度，满黄道宿度去之，即得。
推四正夜半相距度置次正夜半黄道积度，以前正夜半黄道积度减之，余为两正相距度，遇不及减者，加周天减之。
推四正行度加减日差双相距度与相距日下行积度相减，余如相距日而一，为日差。从相距度人减去行积度者为加，从积度内减去相距度者为减。
秋正距冬至，冬至距春正八十八日，行积度九十度四零零九，八十九日行积度九十一度四零一四。春正距夏至，夏至距秋秋正九十三日，行积度九十度五九九零，九十四日行积十五九八七。
推每日夜度置四正后每日行度，在立成。以日差加减之，为每日行定度。置四正夜半日度，以行定度每日加之，满黄道宿度去之，即每日夜半日度。
黄道十二次宿度
危十二度六四九一，入娵訾，辰在亥。
奎一度七三六二，入降娄，辰在戍。
奎度四五六，入大梁，辰在酉。
胃三七度七四五六，入大梁，辰在酉。
毕六度八八零五，入实沈，辰在申。
井八度三四九四，入鹑首，辰在未。
柳三度八六八零，入鹑火，辰在午。
张十五度二六零六，入鹑尾，辰在巳。
轸十度零七九七，入寿星，辰在辰。
氐一度一四五二，入大火，辰在卯。
尾三度一一五，入析木，辰在寅。
斗三度七六八五，入星纪，辰在丑。
女二度零六三八，入玄枵，辰在子。
推日躔黄道入十二次时刻置入次宿度，以入次日夜，以入次日夜半日度减之，余以日周乘之，一分作百分。为实。以入次日夜半日度，与明日夜半日度相减，余为法。实如法而一，各数，以发敛加时求之，即入次时刻。
▲步月离
月平行度一十三度三十六分八十七秒半。
周限三百三十六、半之为中限，又半之为初限。
限平行度零九分六十二秒。
太阳限行八分二十秒。
上弦九十一度三十一发四十三秒太。
望一百八十二度六十二分八十七秒半。
下弦二百七十三度九十四分三十一秒少。
交终度三百六十三度七十九分三十四秒一九六。
朔平行度三百九十四度七八七一一五一六八七五。
推朔后平交日置交终分，风气朔历。减天正经朔交凡分，为朔后平交日。如推次月，累减交差二日三一八六九，得次月朔平交日。不及减交差者，加交终减之，其交又在本月，为重交月朔后平交日。(每岁必有重交之月。)
推平交入转迟疾历置经朔迟疾历，加入朔后平交日为平交入转。在转中已下，其迟疾与经朔同，已上减去转中疾交迟，迟交疾。如推次月，累减交转差三千四百二十三分七六，(交差内减转差数。)即得。如不及减，加转中减之，亦迟疾相代。
推平交入限迟疾差置平交入转迟疾历，依步气朔内，推迟疾差，那得。
推平交加减定差置平交入限迟疾差，双日率八百二十分乘之，以所入迟疾限下行度而一，即得。在迟为加，在疾为减。
推经朔加时积置经朔盈缩历，(见步气朔内。)在盈历即为加时中积，在缩历加半岁周。如推次月，累加朔策，满岁周去之，即各朔加时中积，命日为度。(若月内有二交，后交即注前交经朔加时中积。)
推正交距冬至加时黄道积度及宿次置朔后平交日，以月平行乘之为距后度，加以经朔加时中积，为各月正交距冬至加时黄道积度。加冬至加时黄道日度，(见日躔。)以黄道积度钤减之，至不满宿次，即正交月离。如推次月，累减月平交朔差一度四六三一零二。(以交终度减天周，其数宜为一度四六四零八零。)遇重交月，同次朔。后仿此。
▲黄道积度钤
推正交日辰时刻置朔后症交日，加经朔，去纪法，以平交定差加减之，其日命甲子算外，小余依发敛加时求之，即得正交日辰时刻。如推次月，累加交终，满纪去之。如遇重交，再加交终。
推四正赤道宿次置冬至赤道日度，以气象限累加之，满赤道积度去之，为四正加时赤道日度。
▲赤道积度钤
推正交黄道在二至后初末限置正交距冬至加时黄道积度，在半岁周已下为冬至后，已上减去半岁周，余为夏至后。又视二至后度分，在气象限已下为初限，已上用减半岁周，余为末限。推次月者，若本月初限，则累减月平交朔差，余为次月初限。不及减者，反减月平交朔差，余为次月末限。若本月末限则累加月平交朔差，为次月天限，至满气象限，以减半岁周，余为次月初限。
推定差度置初末限，以象极总差一分六零五五零八乘之，即为定差度。(象极总差，是以象限除极差，其数宜为一十六分零五四四二。)如推次月初限则累减，末限则累加，俱以极平差二十三分四九零二加减之。(极平差，是以月平交朔差，乘象极总差，其数宜为二十三分五零四九。)
推距差度置极差十四度六六，减去定差度，即得。求次月，以极平差加减之。(初限加，末限减。)
推定限度置定差度，以定极总差一分六三七一零七乘之，(定极总差，是以极差除二十四度，其数宜为一度六三七一零七。)所得视正交在冬至后为减，夏至后为加，皆置九十八度加减之，即得。
推月道与赤道正交宿度正交在冬至后，置春正赤道积度，以距差度初限加末限减之，在夏至后，置秋正赤道积度，以距差初限减末限加之。得数，满赤道积度钤去之，即得。
推月道与赤道正交后积度并入初末限视月道与赤道正交所入某宿次，即置本宿赤道全度，减去月道与赤道正交宿度，差为正后积度。以赤道各宿全度累中之，满气象限去之，为半交后。又满去之，为中交后。再满去之，为半交后。视各交积度，在半象限以焉为初限，以上覆减象限，余为末限。
推定差置每交定限度，与初末限相乘，得数，千约之为度，即得。(正交、中交后为加，半交后为减。)
推月道定积度及宿次置月道与赤道各交后每宿积度，以定差加减之，为各交月道积度。加月道与赤道正交定宿度，共为正交后宿度。以前宿定积度减之，即得各交月道宿次。
▲活象限例
置正交后宿次，加前交后半交末宿定积度。为活象限。如正交后宿次度少，加前交不及数，却置正交后宿次加气象限即是。如遇换交之月，置正交后宿次，以前交前半交末宿定积度加之，为换交活象限。假如前交正交是轸，后交正交是角，其前交欠一轸。求活象限者，置正交后宿次，不从翼下取定积度加之，仍于轸下取定积度也。又如前交、正交是轸，后交、正交是翼，其前交多一翼。求活象限者，置正交后宿次，不从翼下取定积度加之，仍于张下取定积度也。
推相距日置定上弦大余，减去定朔大余，即得。上弦至望，望至下弦，下弦至朔仿此。不及减者，加纪法减之。
推定朔弦望入盈历及盈缩定差置各月朔弦望入盈缩历，以朔弦望加减差加减之，并在步气朔内。为定盈缩历。视盈历在盈初限下为盈初已上用减半岁周，余为盈末限。缩历在缩初限已下为缩初限，已上用减半岁周，余为缩末限。依步气朔内求盈缩差，为盈缩定差。
推定朔弦望加时中积置定盈缩历，如是盈历在朔，便为加时中积，在上弦加气象限，在望加半岁周，在下弦加三象限。如是缩历在朔，加半岁周。在上弦加三象限，在望便为加时中积，在下弦加气象限，加后满周天去之。
推黄朔弦望加时中定积度置定朔弦望加时中积，以其下盈缩定差盈加缩之，即得。
推赤道加时积度及宿次置黄道加时定积度，在周天象限已下为至后，已上去之为分后，满两象限去之为至后，满三象限去之为分后。置分至后黄道积度，以立成内分至后积度减之，余以其下赤道度率乘之，如黄道度率而一，得数加入分至后积度，次以所去象限合之，为赤道加时定积度。置赤度加时定积度，加入天正冬至加时赤道日度，满赤道积度钤去之，得定朔弦望赤道加时宿次。
推正半合交后积度置定朔弦望加时赤道宿次，视朔弦望在何交后，正半、中半。即以交生积度，在朔望加时赤道宿前一宿者加之，即为正半中交后积度，满气象限去之，为正半中换交。
推初末限视正半中交后积度，在半象已下为初限，已上覆减气象限，余为末限。
推月道与赤道定差置其交定限度，与初末限相减相乘，所得，千约之为度，即定差。在正交、中交为加。在半交为减。
推定朔弦望加时月道宿次置定朔弦望加时月道定积度，取交后月道定积度，取交后月道定积度，在所置罕前一宿者减之，即得。遇转交则前积度多，所置积度少为不及减。从半转正，加其交活象限减之。从正转半，从半转中，从中转半，皆加气象限减之。
推夜半入转日置经朔弦望迟疾历，以定朔弦望加减差加减之。大疾历，便为定朔弦望加时入转日。在迟历，用加转中置定朔弦望加时入转日，以定朔弦望小余减之，为夜半入转日，遇入转日少不及减者，加转终减之。
推加时入转度置定朔弦望小余，去秒，取夜半入转日下转定度乘之，万约之为分，即得。
▲迟疾转定度钤
推定朔弦望夜半入转积度及宿次置定朔弦望加时月道定积度，减去加时入转度，为夜半积度。如朔弦望加时定积度初换交，则不及减，半正相接，用活象限，正半、中半相接，用气象限加之，然后减加时入转度，则正者为后年，后年为中，中为前半，前半为正。置朔弦望夜半月道定积度，依推定朔弦望加时月道宿次法减之，为夜半宿次。
推晨昏入转日及转度置夜半入转日，以定盈缩历检立成日下晨分加之，为晨入转日(满转终去之。)置其日晨分，取夜半入转日下转定度乘之，万约为分，为晨转度。如求昏转日转度，依法检日下昏分，即得。
推晨昏转积度及宿次置朔弦望夜半月道定积度，加晨转度，为晨转积度。如求昏转积度，则加昏转度，满气象限去之，则换交。(若推夜半积度之时，因朔弦望加时定积不及减转度，以半正相接，而加活象限之者，今复换正交，则以活象限减之。)置晨转积度，依前法减之，为晨分宿次。置昏转积度，依法减之，为昏分宿次。
推相距度朔与上弦相距，上弦与望相距，用昏转积度。望与下弦相距，下弦与朔相距，用晨转积度。置后段晨昏转积度，视与前段同交者，竟以前段晨昏转积度减之，余为相距度。若后段与前段接两交者，从正入半，从半入中，从中入半，加气象限。从半入正，加活象限。然后以前段晨昏转积度减之。若后段与前段接三交者，其内无从半入正，则加二气象限，其内有从半入正，则加一活象限，一气象限，以前段晨昏转积度减之。
推转定积度置晨昏入转日，(朔至弦，弦至望，用昏。望至弦，弦至朔，用晨。)以前段减后段，不及减者，加二十八日减之，为晨昏相距日。从前段下，于钤内验晨昏相距日同者，取其转定积度。若朔弦望相距日少晨昏相距日一日者，则于晨昏相距日同者，取其转积度，减去转定极差一十四度七一五四，余为前段至后段转定积度。
▲转定积度钤
(以下表格略)
推加减差以相距度与转定积度相减为实，以其朔弦望相距目为法除之，所得视相距度多为加差，少为减差。
推每日太阴行定度置朔弦望晨昏入转日，视迟疾转定度钤日下转定度，累日以加减差加减之，至所距日而止，即得。
推每日月离晨昏宿次置朔弦望晨昏宿次，以每日太阴行度加之，满月道宿次减之，即得。
▲赤道十二宫界宿次
推月与赤道正交后宫界积度视月道与赤道正交后，各宿积度宫界，某宿次在后，即以加之，便为某宫正交后宫界积度。求次宫者，累加宫率二十度四三八一，满气象限去之，各得某宫下半产交后宫界积度。
推宫界定积度视宫界度在半象限已下为初限，已上覆减气象限，余为末限。置某交定限度，与初末限相减、相乘，所得，千约之为度，在正交、中交为加差，在半交为减差。置宫界正半中交后积度，以定差加减之，为宫界定积度。
推宫界宿次置宫界定积度，于月道内取其在所置前一宿者减之之不及减者，加气象限减之。
推每月每日下交宫时刻置每月宫界宿次，减入交宫日下月离晨昏宿次。如不及减者，加宫界宿次前宿减之，余以日周乘之，以其日太阴行定度而一，得数，又视定盈缩历取立成日下晨昏分加之。(晨加晨分，昏加昏分。)
如满日周交宫在次日，不满在本日，依发敛推之，即交宫时刻。
▲步中星
推每日夜半赤道置推到每日夜半黄道，见日躔。依法以黄道积度减之，余如黄道率而一，以加赤道积度。又以天正科至赤道加之，如在春正后，再加一象限，夏至后加半周天，秋正后加三象限，为每日夜半赤道积度。
推夜半赤道宿度置夜半赤道度，以赤道宿度挨次减之，为本日夜半赤道宿度。
推晨距度及更差度置立成内每日晨分，以三百六十六度二十五分七十五秒乘之为实，如日周而一，为晨距度。倍晨距度，以五除之，为更差度。
推每日夜半中星置推到每日夜半赤道宿度，加半周天，即夜半中唾积度。以赤道度挨次减之，为夜半中星宿度。
推昏旦中星置夜半中星积度，减晨距度，为昏中星积度。以更差度累加之，为遂更及旦中星积度。俱满赤道宿度去之，即得。以晨分五之一，加们为更率。更率五而一为点率。凡昏分，即一更一点，累加更率为各更。凡交更即为一点，累加点率为各点。

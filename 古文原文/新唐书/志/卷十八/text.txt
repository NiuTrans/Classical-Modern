历四上
《开元大衍历》演纪上元阏逢困敦之岁，距开元十二年甲子，积九千六百九十六万一千七百四十算。
○一曰步中朔术
通法三千四十。
策实百一十一万三百四十三。
揲法八万九千七百七十三。
减法九万一千二百。
策余万五千九百四十三。
用差万七千一百二十四。
挂限八万七千一十八。
三元之策十五，余六百六十四，秒七。
四象之策二十九，余千六百一十三。
中盈分千三百二十八，秒十四。
朔虚分千四百二十七。
爻数六十。
象统二十四。
以策实乘积算，曰中积分。盈通法得一，为积日。爻数去之，余起甲子算外，得天正中气。凡分为小余，日为大余。加三元之策，得次气。凡率相因加者，下有余秒，皆以类相从。而满法迭进，用加上位。日盈爻数去之。
以揲法去中积分，不尽曰归余之挂。以减中积分，为朔积分。如通法为日，去命如前，得天正经朔。加一象之日七、余千一百六十三少，得上弦。倍之，得望。参之，得下弦。四之，是谓一揲，得后月朔。凡四分，一为少，三为太。综中盈、朔虚分，累益归余之挂，每其月闰衰。凡归余之挂五万六千七百六十以上，其岁有闰。因考其闰衰，满挂限以上，其月合置闰。或以进退，皆以定朔无中气裁焉。
凡常气小余不满通法、如中盈分之半已下者，以象统乘之，内秒分，参而伍之，以减策实；不尽，如策余为日。命常气初日算外，得没日。凡经朔小余不满朔虚分者，以小余减通法，余倍参伍乘之，用减灭法；不尽，如朔虚分为日。命经朔初日算外，得灭日。
○二曰发敛术
天中之策五，余二百二十一，秒三十一；秒法七十二。
地中之策六，余二百六十五，秒八十六；秒法百二十。
贞悔之策三，余百三十二，秒百三。
辰法七百六十。
刻法三百四。
各因中节命之，得初候。加天中之策，得次候。又加，得末候。因中气命之，得公卦用事。以地中之策累加之，得次卦，若以贞悔之策加侯卦，得十有二节之初外卦用事。因四立命之，得春木、夏火、秋金、冬水用事。以贞悔之策减季月中气，得土王用事。凡相加减而秒母不齐，当令母互乘子，乃加减之；母相乘为法。
各以能法约其月闰衰，为日，得中气去经朔日算。求卦、候者，各以天、地之策，累加减之。凡发敛加时，各置其小余，以六爻乘之，如辰法而一，为半辰之数。不尽者，三约为分。分满刻法为刻。若令满象积为刻者，即置不尽之数，十之，十九而一，为分。命辰起子半算外。
○三曰步日躔术
干实百一十一万三百七十九太。
周天度三百六十五，虚分七百七十九太。
岁差三十六太。
以盈缩分盈减、缩加三元之策，为定气所有日及余。乃十二乘日，又三其小余，辰法约而一，从之，为定气辰数。不尽，十之，又约为分。以所入气并后气盈缩分，倍六爻乘之，综两气辰数除之，为末率。又列二气盈缩分，皆倍六爻乘之，各如辰数而一；以少减多，余为气差。至后以差加末率，分后以差减末率，为初率。倍气差，亦倍六爻乘之，复综两气辰数除，为日差。半之，以加减初末，各为定率。以日差至后以减、分后以加气初定率，为每日盈缩分。乃驯积之，随所入气日加、减气下先、后数，各其日定数。其求朓朒仿此。冬至后为阳复，在盈加之，在缩减之；夏至后为阴复，在缩加之，在盈减之。距四正前一气，在阴阳变革之际，不可相并，皆因前末为初率。以气差至前加之，分前减之，为末率。余依前术，各得所求。其分不满全数，母又每气不同，当退法除之。以百为母，半已上，收成一。冬至、夏至偕得天地之中，无有盈、缩。余各以气下先后数先减、后加常气小余，满若不足，进退其日，得定大小余。凡推日月度及轨漏、交蚀，依定气；注历，依常气。以减经朔、弦、望，各其所入日算。若大余不足减，加爻数，乃减之。减所入定气日算一，各以日差乘而半之；前少以加、前多以减气初定率，以乘其所入定气日算及余秒。凡除者，先以母通全，内子，乃相乘；母相乘除之。所得以损益朓朒积，各其入朓朒定数。若非朔、望有交者，以十二乘所入日算；三其小余，辰法除而从之；以乘损益率，如定气辰数而一。所得以损益朓朒积，各为定数。
南斗二十六，牛八，婺女十二，虚十，虚分七百七十九太。危十七，营室十六，东壁九，奎十六，娄十二，胃十四，昴十一，毕十七，觜觿一，参十，东井三十三，舆鬼三，柳十五，七星七，张十八，翼十八，轸十七，角十二，亢九，氐十五，房五，心五，尾十八，箕十一，为赤道度。其毕、觜觿、参、舆鬼四宿度数，与古不同，依天以仪测定，用为常数。纮带天中，仪极攸凭，以格黄道。
推冬至岁差所在，每距冬至前后各五度为限，初数十二，每限减一，尽九限，数终于四。当二立之际，一度少强，依平。乃距春分前、秋分后，初限起四，每限增一，尽九限，终于十二，而黄道交复。计春分后、秋分前，亦五度为限。初数十二，尽九限，数终于四。当二立之际，一度少强，依平。乃距夏至前后，初限起四，尽九限，终于十二。皆累裁之，以数乘限度，百二十而一，得度；不满者，十二除，为分。若以十除，则大分，十二为母，命太、半、少及强、弱。命曰黄、赤道差数。二至前、后各九限，以差减赤道度，二分前、后各九限，以差加赤道度，各为黄道度。
开元十二年，南斗二十三半，牛七半，婺女十一少，虚十，六虚之差十九太。危十七太，营室十七少，东壁九太，奎十七半，娄十二太，胃十四太，昴十一，毕十六少，觜觿一，参九少，东井三十，舆鬼二太，柳十四少，七星六太，张十八太，翼十九少，轸十八太，角十三，亢九半，氐十五太，房五，心四太，尾十七，箕十少，为黄道度，以步日行。日与五星出入，循此。求此宿度，皆有余分，前后辈之成少、半、太，准为全度。若上考往古，下验将来，当据岁差，每移一度，各依术算，使得当时度分，然后可以步三辰矣。
以乾实去中积分，不尽者，盈通法为度。命起赤道虚九，宿次去之，经虚去分，至不满宿算外，得冬至加时日度。以三元之策累加之，得次气加时日度。
以度余减通法，余以冬至日躔距度所入限数乘之，为距前分。置距度下黄、赤道差，以通法乘之，减去距前分，余满百二十除，为定差。不满者，以象统乘之，复除，为秒分。乃以定差减赤道宿度，得冬至加时黄道日度。
又置岁差，以限数乘之，满百二十除，为秒分。不尽为小分。以加三元之策，因累裁之。命以黄道宿次，各得定气加时日度。
置其气定小余，副之。以乘其日盈、缩分，满通法而一，盈加、缩减其副。用减其日加时度余，得其夜半日度。因累加一策，以其日盈、缩分盈加、缩减度余，得每日夜半日度。
○四曰步月离术
转终六百七十万一千二百七十九。
转终日二十七，余千六百八十五，秒七十九。
转法七十六。
转秒法八十。
以秒法乘朔积分，盈转终去之；余复以秒法约，为入转分；满通法，为日。命日算外，得天正经朔加时所入。因加转差日一、余二千九百六十七、秒一，得次朔。以一象之策，循变相加，得弦、望。盈转终日及余秒者，去之。各以经朔、弦、望小余减之，得其日夜半所入。
各置朔、弦、望所入转日损益率，并后率而半之，为通率。又二率相减，为率差。前多者，以入余减通法，余乘率差，盈通法得一，并率差而半之；前少者，半入余，乘率差，亦以通法除之：为加时转率。乃半之，以损益加时所入，余为转余。其转余，应益者，减法；应损者，因余。皆以乘率差，盈通法得一，加于通率，转率乘之，通法约之，以朓减、朒加转率，为定率。乃以定率损益朓肉积，为定数。其后无同率者，亦因前率。应益者，以通率为初数，半率差而减之；应损者，即为通率。其损益入余进退日，分为二日，随余初末，如法求之，所得并以损益转率。此术本出《皇极历》，以究算术之微变。若非朔、望有交者，直以入余乘损益率，如通法而一，以损益朓朒，为定数。
七日、初数二千七百一，末数三百三十九。十四日、初数二千三百六十三，末数六百七十七。二十一日、初数二千二十四，末数千一十六。二十八日，初数千六百八十六，末数千三百五十四。以四象约转终，均得六日二千七百一分。就全数约为九分日之八。各以减法，余为末数。乃四象驯变相加，各其所当之日初、末数也。视入转余，如初数已下者，加减损益，因循前率；如初数以上，则反其衰，归于后率云。
各置朔、弦、望大小余，以入气、入转朓朒定数，朓减、朒加之，为定朔、弦、望大小余。定朔日名与后朔同者，月大；不同者，小；无中气者，为闰月。凡言夜半，皆起晨前子正之中。若注历，观弦、望定小余，不盈晨初余数者，退一日。其望有交、起亏在晨初已前者，亦如之。又月行九道迟疾，则有三大二小以日行盈、缩累增、损之，则容有四大三小，理数然也。若俯循常仪，当察加时早晚，随其所近而进退之，使不过三大二小。其正月朔有交、加时正见者，消息前后一两月，以定大小，令亏在晦、二。定朔、弦、望夜半日度，各随所直日度及余分命之。乃列定朔、弦、望小余，副之。以乘其日盈、缩分，如通法而一，盈加、缩减其副。以加夜半日度，各得加时日度。
凡合朔所交，冬在阴历、夏在阳历，月行青道；冬至、夏至后，青道半交在春分之宿，当黄道东。立冬、立夏后，青道半交在立春之宿，当黄道东南。至所冲之宿，亦如之。冬在阳历、夏在阴历，月行白道；冬至、夏至后，白道半交在秋分之宿，当黄道西。立冬、立夏后，白道半交在立秋之宿，当黄道西北。至所冲之宿，亦如之。春在阳历、秋在阴历，月行硃道；春分、秋分后，硃道半交在夏至之宿，当黄道南。立春、立秋后，硃道半交在立夏之宿，当黄道西南。至所冲之宿，亦如之。春在阴历，秋在阳历，月行黑道。春分、秋分后，黑道半交在冬至之宿，当黄道北，立春、立秋后，黑道半交在立冬之宿，当黄道东北。至所冲之宿，亦如之。四序离为八节，至阴阳之所交，皆与黄道相会，故月有九行。各视月交所入七十二候距交初中黄道日度，每五度为限，亦初数十二，每限减一，数终于四、乃一度强，依平。更从四起，每限增一，终于十二，而至半交，其去黄道六度。又自十二，每限减一，数终于四，亦一度强，依平。更从四起，每限增一，终于十二，复与日轨相会。各累计其数，以乘限度，二百四十而一，得度。不满者，二十四除，为分，若以二十除之，则大分，以十二为母。为月行与黄道差数。距半交前后各九限，以差数为减；距正交前后各九限，以差数为加。此加减出入六度，单与黄道相较之数。若较之赤道，则随气迁变不常。计去冬至、夏至以来候数，乘黄道所差，十八而一，为月行与赤道差数。凡日以赤道内为阴，外为阳；月以黄道内为阴，外为阳。故月行宿度，入春分交后行阴历、秋分交后行阳历，皆为同名。若入春分交后行阳历、秋分交后行阴历，皆为异名。其在同名，以差数为加者加之，减者减之；若在异名，以差数为加者减之，减者加之。皆以增损黄道度，为九道定度。
各以中气去经朔日算，加其入交泛，乃以减交终，得平交入中气日算。满三元之策去之，余得入后节日算。因求次交者，以交终加之，满三元之策去之，得后平交入气日算。
各以气初先后数先加、后减之，得平交入定气日算。倍六爻乘之，三其小余，辰法除而从之，以乘其气损益率，如定气辰数而一，所得以损益其气朓朒积，为定数。
又置平交所入定气余，加其日夜半入转余，以乘其日损益率，满通法而一，以损益其日朓朒积，交率乘之，交数而一，为定数。乃以入气入转朓朒定数，朓减、朒加平交入气余，满若不足，进退日算，为正交入定气日算。其入定气余，副之，乘其日盈缩分，满通法而一，以盈加、缩减其副，以加其日夜半日度，得正交加时黄道日度。以正交加时度余减通法，余以正交之宿距度所入限数乘之，为距前分。置距度下月道与黄道差，以通法乘之，减去距前分，余满二百四十除，为定差；不满者一退为秒。以定差及秒加黄道度、余，仍计去冬至、夏至已来候数乘定差，十八而一，所得依名同异而加减之，满若不足，进退其度，得正交加时月离九道宿度。
各置定朔、弦、望加时日度，从九道循次相加。凡合朔加时，月行潜在日下，与太阳同度，是谓离象。先置朔、弦、望加时黄道日度，以正交加时所在黄道宿度减之，余以加其正交九道宿度，命起正交宿度算外，即朔、弦、望加时所当九道宿度也。其合朔加时，若非正交，则日在黄道，月在九道，各入宿度虽多少不同，考其去极，若应绳准。故云：月行潜在日下，与太阳同度。以一象之度九十一、余九百五十四、秒二十二半为上弦，兑象。倍之，而与日冲，得望，坎象。参之，得下弦，震象。各以加其所当九道宿度，秒盈象统从余，余满通法从度，得其日加时月度。综五位成数四十，以约度余，为分；不尽者，因为小分。
视经朔夜半入转，若定朔大余有进退者，亦加、减转日。否则因经朔为定。累加一日，得次日，各以夜半入转余乘列衰，如通法而一，所得以进加、退减其日转分，为月转定分。满转法，为度。
视定朔、弦、望夜半入转，各半列衰以减转分。退者，定余乘衰，以通法除，并衰而半之；进者，半余乘衰，亦以通法除：皆加所减。乃以定余乘之，盈通法得一，以减加时月度，为夜半月度。各以每日转定分累加之，得次日。若以入转定分，乘其日夜漏，倍百刻除，为晨分。以减转定分，余为昏分。望前以昏、望后以晨加夜半度，各得晨、昏月。
各视每日夜半入阴阳历交日数，以其下屈伸积，月道与黄道同名者，加之；异名者，减之。各以加、减每日辰昏黄道月度，为入宿定度及分。
○五曰步轨漏术
爻统千五百二十。
象积四百八十。
辰八刻百六十分。
昏、明二刻二百四十分。
各置其气消息衰，依定气所有日，每以陟降率陟减、降加其分，满百从衰，各得每日消息定衰。其距二分前后各一气之外，陟、降不等，皆以三日为限。雨水初日，降七十八；初限，日损十二；次限，日损八；次限，日损三；次限，日损二；次限，日损后。清明初日，陟一；初限，日益一；次限，日益二；次限，日益三；次限，日益八；末限，日益十九。处暑初日，降九十九；初限，日损十九；次限，日损八；次限，日损三；次限，日损二；末限，日损一。寒露初日，陟一；初限，日益一；次限，日益二；次限，日益三；次限，日益八；末限，日益十二。各置初日陟降率，依限次损益之，为每日率。乃递以陟减、降加气初消息衰，各得每日定衰。
南方戴日之下，正中无晷。自戴日之北一度，乃初数千三百七十九。自此起差，每度增一，终于二十五度，计增二十六分。又每度增二，终于四十度。又每度增六，终于四十四度，增六十八。又每度增二，终于五十度。又每度增七，终于五十五度。又每度增十九，终于六十度，增百六十。又每度增三十三，终于六十五度。又每度增三十六，终于七十度。又每度增三十九，终于七十二度，增二百六十。又度增四百四十。又度增千六十。又度增千八百六十。又度增二千八百四十。又度增四千。又度增五千三百四十。各为每度差。因累其差，以递加初数，满百为分，分十为寸，各为每度晷差。又累其晷差，得戴日之北每度晷数。
各置其气去极度，以极去戴日度五十六及分八十二半减之，得戴日之北度数。各以其消息定衰所直度之晷差，满百为分，分十为寸，得每日晷差。乃递以息减、消加其气初晷数，得每日中晷常数。
以其日处在气定小余，爻统减之，余为中后分。不足减，反相减，为中前分。以其晷差乘之，如通法而一，为变差。以加、减中晷常数，冬至后，中前以差减，中后以差加；夏至后，中前以差加，中后以差减。冬至一日，有减无加；夏至一日，有加无减。得每日中晷定数。
又置消息定衰，满象积为刻，不满为分。各递以息减、消加其气初夜半漏，得每日夜半漏定数。其全刻，以九千一百二十乘之，十九乘刻分从之，如三百而一，为晨初余数。
各倍夜半漏，为夜刻。以减百刻，余为昼刻。减昼五刻以加夜，即昼为见刻，夜为没刻。半没刻加半辰，起子初算外，得日出辰刻。以见刻加而命之，得日入。置夜刻，五而一，得每更差刻。又五除之，得每筹差刻。以昏刻加日入辰刻，得甲夜初刻。又以更筹差加之，得五夜更筹所当辰。其夜半定漏，亦名晨初夜刻。
又置消息定衰，满百为度，不满为分。各递以息减、消加气初去极度，各得每日去极定数。
又置消息定衰，以万二千三百八十六乘之，如万六千二百七十七而一，为度差。差满百为度。各递以息加、消减其气初距中度，得每日距中度定数。倍之，以减周天，为距子度。
置其日赤道日度，加距中度，得昏中星。倍距子度，以加昏中星，得晓中星。命昏中星为甲夜中星，加每更差度，得五夜中星。
凡九服所在，每气初日中晷常数不齐。使每气去极度数相减，各为其气消息定数。因测其地二至日晷，测一至可矣，不必兼要冬夏。于其戴日之北每度晷数中，较取长短同者，以为其地戴日北度数及分。每气各以消息定数加减之，因冬至后者，每气以减。因夏至后者，每气以加。得每气戴日北度数。各因所直度分之晷数，为其地每定气初日中晷常数。其测晷有在表南者，亦据其晷尺寸长短与戴日北每度晷数同者，因取其所直之度，去戴日北度数。反之，为去戴日南度。然后以消息定数加减之。
二至各于其地下水漏以定当处昼夜刻数。乃相减，为冬、夏至差刻。半之，以加、减二至昼夜刻数，为定春、秋分初日昼夜刻数。乃置每气消息定数。以当处差刻数乘之，如二至去极差度四十七分，八十而一，所得依分前、后加、减初日昼夜漏刻，各得余定气初日昼夜漏刻。
置每日消息定衰，亦以差刻乘之，差度而一，所得以息减、消加其气初漏刻，得次日。其求距中度及昏明中星日出入，皆依阳城法求之。仍以差刻乘之，差度而一，为今有之数。若置其地春、秋定日中晷常数与阳城每日晷数，较其同者，因其日夜半漏亦为其地定春、秋分初日夜半漏。求余定气初日，亦以消息定数依分前、后加、减刻分，春分后以减，秋分后以加。满象积为刻。求次日，亦以消息定衰，依阳城术求之。此术究理，大体合通。然高山平川，视日不等。较其日晷，长短乃同。考其水漏，多少殊别。以兹参课，前术为审。
历四下
○六曰步交会术
终数八亿二千七百二十五万一千三百二十二。
交终日二十七，余六百四十五，秒千三百二十二。
中日十三，余千八百四十二，秒五千六百六十一。
朔差日二，余九百六十七，秒八千六百七十八。
望差日一，余四百八十三，秒九千三百三十九。
望数日十四，余二千三百二十六，秒五千。
交限日十二，余千三百五十八，秒六千三百二十二。
交率三百四十三。
交数四千三百六十九。
交秒法一万。
以交数去朔积分；不尽，以秒法乘之，盈交数又去之；余如秒法而一，为入交分。满通法为日，命日算外，得天正经朔时加入交泛日及余。因加朔差，得次朔。以望数加朔，得望。若以经朔望小余减之，各得夜半所入。累加一日，得次日。加之满交终，去之。各以其日入气朓朒定数，朓减、朒加入交泛，为入交常日及余。又以交率乘其日入转朓朒定数，如交数而一，而朓减、朒加入交常，为入交定日及余。各如中日已下者，为月入阳历；已上者，去之，余为月入阴历。
○阴阳历
以其爻加减率与后爻加减率相减，为前差。又以后爻率与次后爻率相减，为后差。二差相减，为中差。置所在爻并后爻加减率，半中差以加而半之，十五而一，为爻末率，因为后爻初率。每以本爻初、末率相减，为爻差。十五而一，为度差。半之，以加减初率，少象减之，老象加之。为定初率。每以度差累加减之，少象以差减，老象以差加。各得每岁加减定分。乃循积其分，满百二十为度，各为月去黄道数及分。其四象初爻无初率，上爻无末率，皆倍本爻加减率，十五而一。所得各以初、末率减之，皆互得其率。
各置夜半入转，以夜半入交定日及余减之，不足减，加转终。余为定交初日夜半入转。乃以定交初日与其日夜半入余，各乘其日转定分，如通法而一，为分。满转法，为度。各以加其日转积度分，乃相减，所余为其日夜半月行入阴阳度数。转求次日，以转定分加之。以一象之度九十除之，若以少象除之，则兼除差度一、度分百六、大分十三、小分十四。讫，然后以次象除之。所得以少阳、老阳、少阴、老阴为次，起少阳算外，得所入象度数及分。先以三十乘阴阳度分，十九而一，为度分。不尽，以十五乘、十九除，为大分。不尽者，又乘、又除，为小分。然后以象度及分除之。乃以一爻之度十五除之，所得入爻度数及分。其月行入少象初爻之内及老象上爻之中，皆沾黄道。当朔望，则有亏蚀。
凡入交定如望差已下，交限已上，为入蚀限；望入蚀限，则月蚀。朔入蚀限，月在阴历，则日蚀。如望差已下，为交后。交限已上，以减交中，余为交前。置交前、后定日及余，通之，为去交前、后定分。十一乘之，二千六百四十三除，为去交度数。不尽，以通法乘之，复除为余。大抵去交十三度已上，虽入蚀限，为涉交数微，光景相接，或不见蚀。望去交分七百七十九已下者，皆既。已上者，以定交分减望差，余以百八十三约之，命以十五为限，得月蚀之大分。
月在阴历，初起东南，甚于正南，复于西南；月在阳历，初起东北，甚于正北，复于西北。其蚀十二分已上者，起于正东，复于正西。此据午正而论之。余各随方面所在，准此取正。
凡月蚀之大分五已下，因增三。十已下，因增四。十已上，因增五。其去交定分五百二十已下，又增半。二百六十已下，又增半。各为泛用刻率。
以所入气并后气增损差，倍六爻乘之，综两气辰数除之，为气末率。又列二气增损差，皆倍六爻乘之，各如辰数而一；少减多，余为气差。加减末率冬至后以差减，夏至后以差加。为初率。倍气差，综两气辰数除，为日差。半之，加减初、末，为定率。以差累加、减气初定率，冬至后以差加，夏至后以差减。为每日增损差。乃循积之，随所入气日增损气下差积，各其日定数。其二至之前一气，皆后无同差，不可相并，各因前末为初率。以气差冬至前减、夏至前加，为末率。
阴历蚀差千二百七十五，蚀限三千五百二十四，或限三千六百五十九。阳历蚀限百三十五，或限九百七十四。以蚀朔所入气日下差积，阴历减之，阳历加之，各为蚀定差及定限。朔在阴历，去交定分满蚀定差已上者，为阴历蚀。不满者，虽在阴历，皆类同阳历蚀。其去交定分满定限已下者，的蚀。或限已下者，或蚀。
阴历蚀者，置去交定分，以蚀定差减之，余百四已下者，皆蚀既。已上者，以百四减之。余以百四十三约之。其入或限者，以百五十二约之。半已下，为半弱。半已上，为半强。以减十五，余为日蚀之大分。其同阳历蚀者，其去交定分少于蚀定差六十已下者，皆蚀既。已上者，以阳历蚀定限加去交分，以九十约之。其阳历蚀者，置去交定分，亦以九十约之。入或限者，以百四十三约之。皆半已下，为半弱。半已上，为半强。命之，以十五为限，得日蚀之大分。
月在阴历，初起西北，甚于正北，复于东北。月在阳历，初起西南，甚于正南，复于东南。其蚀十二分已上，皆起于正西，复于正东。
凡日蚀之大分，皆因增二。其阴历去交定分多于蚀定差七十已上者，又增；三十五已下者，又增半。其同阳历去交定分少于蚀定差二十已下者，又增半；四已下者，又增少。各为泛用刻率。
置去交定分，以交率乘之，二十乘交数除之；其月道与黄道同名者，以加朔望定小余：异名者，以减朔、望定小余：为蚀定余。如求发敛加时术入之，得蚀甚辰刻。各置泛用刻率，副之。以乘其日入转损益率，如通法而一。所得应朒者，依其损益；应朓者，损加、益减其副：为定用刻数。半之，以减蚀甚辰刻，为亏初；以加蚀甚辰刻，为复末。其月蚀，置定用刻数，以其日每更差刻除，为更数。不尽，以每筹差刻除，为筹数。综之为定用更筹。乃累计日入后至蚀甚辰刻，置之，以昏刻加日入辰刻减之，余以更筹差刻除之。所得命以初更筹算外，得蚀甚更筹。半定用更筹减之，为亏初；加之，为复末。按天竺俱摩罗所传断日蚀法，日躔郁车宫者，的蚀。其余据日所在宫，火星在前三及后五之宫，并伏在日下，则不蚀。若五星皆见，又水在阴历及三星已上同聚一宿，则亦不蚀。凡星与日别宫或别宿则易断，若同宿则难。天竺所云十二宫，即中国之十二次。郁车宫者，降娄之次也。
九服之地，蚀差不同。先测其地二至及定春秋分中晷长短，与阳城每日中晷常数较取同者，各因其日蚀差为其地二至及定春秋分蚀差。以夏至差减春分差，以春分差减冬至，各为率。并二率，半之，六而一，为夏率。二率相减，六而一，为总差。置总差，六而一，为气差。半气差，以加夏率，又以总差减之，为冬率。冬率即冬至率。每以气差加之，各为每气定率。乃循积其率，以减冬至蚀差，各得每气初日蚀差。求每日，如阳城法求之。若戴日之南，当计所在地，皆反用之。
○七曰步五星术
△岁星
终率百二十一万二千五百七十九，秒六。
终日三百九十八，余二千六百五十九，秒六。
变差三十四，秒十四。
象算九十一，余二百三十八，秒五十七，微分十二。
爻算十五，余百六十六，秒四十二，微分八十二。
△荧惹
终率二百三十七万一千三，秒八十六。
终日七百七十九，余二千八百四十三，秒八十六。
变差三十二，秒二。
象算九十一，余二百三十八，秒四十三，微分八十四。
爻算十五，余百六十六，秒四十，微分六十二。
△镇星
终率百一十四万九千三百九十九，秒九十八。
终日三百七十八，余二百七十九，秒九十八。
变差二十二，秒九十二。
象算九十一，余二百三十七，秒八十七。
爻算十五，余百六十六，秒三十一，微分十六。
△太白
终率百七十七万五千三十，秒十二。
终日五百八十三，余二千七百一十一，秒十二。
中合日二百九十一，余二千八百七十五，秒六。
变差三十，秒五十三。
象算九十一，余二百三十八，秒三十四，微分五十四。
爻算十五，余百六十六，秒三十九，微分九。
△辰星
终率三十五万二千二百七十九，秒七十二。
终日百一十五，余二千六百七十九，秒七十二。
中合日五十七，余二千八百五十九，秒八十六。
变差百三十六，秒七十八。
象算九十一，余二百四十四，秒九十八，微分六十。
爻算十五，余百六十七，秒四十九，微分七十四。
辰法七百六十。
秒法一百。
微分法九十六。
置中积分，以冬至小余减之，各以其星终率去之，不尽者，返以减终率；余满通法为日，得冬至夜半后平合日算。各以其星变差乘积算，满干实去之；余满通法，为日。以减平合日算，得入历算数。皆四约其余，同于辰法。及以一象之算除之，以少阳、老阳、少阴、老阴为次，起少阳算外。余以一爻之算除之；所得命起其象初爻算外，得外入爻算数。
○五星爻象历
以所入爻与后爻损益率相减，为前差；又以后爻与次后爻损益率相减，为后差；二差相减，为中差。置所入爻并后爻损益率，半中差以加之，九之，二百七十四而一，为爻末率，因为后爻初率。皆因前爻末率，以为后爻初率。初、末之率相减，为爻差。倍爻差，九之，二百七十四而一，为算差。半之，加减初、末，各为定率。以算差累加、减爻初定率，少象以差减，老象以差加。为每算损益率。循累其率，随所入爻损益其下进退积，各得其算定数。其四象初爻无初率，上爻无末率，皆置本爻损益率四而九之，二百七十四得一，各以初、末率减之，皆互得其率。
各置其星平合所入爻之算差，半之，以减其入算损益率。损者，以所入余乘差，辰法除，并差而半之；益者，半入余，乘差，亦辰法除：皆中所减之率。乃以入余乘之，辰法而一。所得以损益其算下进退，各为平合所入定数。
置进退定数，金星则倍置之。各以合下乘数乘之，除数除之。所得满辰法为日，以进加、退减平合日算，先以四约平合余，然后加减。为常合日算。
置常合日先后定数，四而一，以先减、后加常合日算，得定合日算。又四约盈缩分，以定合余乘之，满辰法而一。所得以盈加、缩减其定余，加其日夜半日度，为定合加时星度。
又置定合日算，以冬至大小余加之，天正经朔大小余减之。其至朔小余，皆先以四约之。若大余不足减，又以爻数加之，乃减之。余满四象之策除，为月数。不尽者，为入朔日算。命月起天正、日起经朔算外，得定合月、日。视定朔与经朔有进退者，亦进减、退加一日为定。
置常合及定合应加减定数，同名相从，异名相消；乃以加减其平合入爻算，满若不足，进退爻算，得定合所入。乃以合后诸变历度累加之，去命如前，得次变初日所入。如平合求进退定数，乃以乘数乘之，除数除之，各为进退变率。
五星变行日中率、度中率、差行损益率、历度乘数、除数
○岁星
合后伏：十七日三百三十二分，行三度三百三十二分。先迟，二日益疾九分。历，一度三百五十七分。乘数三百五十，除数二百八十一。
前顺：百一十二日，行十八度六百五十六分。先疾，五日益迟六分。历，九度三百三十七分。乘数三百五十，除数二百八十一。
前留：二十七日。历，二度二百二十分。乘数二百六十七，除数二百二十一。
前退：四十三日，退五度三百六十九分。先迟，六日益疾十一分。历，三度四百七十五分。乘数四百七十，除数四百三。
后退：四十三日，退五度三百六十九分。先迟，六日益迟十一分。历，三度四百七十五分。乘数五百一十，除数四百六十七。
后留：二十七日。历，三度二百一十分。乘数二百七十，除数二百二十二。
后顺：百一十二日，行十八度六十五分。先迟，五日益疾六分。历，九度三百三十七分。乘数二百六十七，除数二百二十七。
合前伏：十七日三百三十二分，行三度三百三十二分。先疾，二日益迟九分。历，一度三百五十八分。乘数三百五十，除数二百八十一。
○荧惑
合后伏：七十一日七百三十五分，行五十四度七百三十五分。先疾，五日益迟七分。历，三十八度二百一分。乘数百二十七，除数三十。
前疾：二百一十四日，行百三十六度。先疾，九日益迟四分。历，百一十三度五百九十六分。乘数百二十七，除数三十。
前迟：六十日，行二十五度。先疾，日益迟四分。历，三十一度六百八十五分。乘数二百三，除数五十四。
前留：十三日，历，六度六百九十三分。乘数二百三，除数五十四。
前退：三十一日，退八度四百七十三分。先迟，六日益疾五分。历，十六度三百六十七分。乘数二百三，除数四十八。
后退：三十一日，退八度四百七十三分。先疾，六日益迟五分。历，十六度三百六十七分。乘数二百三，除数四十八。
后留：十三日。历，六度六百九十三分。乘数二百三，除数四十八。
后迟：六十日，行二十五度。先迟，日益疾四分。历，三十一度六百八十五分。乘数二百三，除数五十四。
后疾：二百一十四日，行百三十六度。先迟，九日益疾四分。历，百一十三度五百九十六分。乘数二百三，除数五十四。
合前伏：七十一日七百三十六分，行五十四度七百三十六分。先迟，五日益疾七分。历，三十八度二百一分。乘数百二十七，除数三十。
○镇星
合后伏：十八日四百一十五分，行一度四百一十五分。先迟，二日益疾九分。历，四百八十分。乘数十二，除数十一。
前顺：八十三日，行七度二百四十一分。先疾，六日益迟五分。历，二度六百二十三分。乘数十二，除数十一。
前留：三十七日三百八十分。历，一度二百八分。乘数十，除数九。
前退：五十日，退二度三百三十四分。先迟，七日益疾一分。历，一度五百三十一分。乘数二十，除数十七。
后退：五十日，退二度三百三十四分，先疾，七日益迟一分。历，一度五百三十一分。乘数五，除数四。
后留：三十七日三百八十分。历，一度二百八分。乘数二十，除数一十七。
后顺：八十三日，行七度二百四十一分。先迟，六日益疾五分。历，二度六百二十三分。乘数十，除数九。
合前伏：十八日四百一十五分，行一度四百一十五分。先疾，二日益迟九分。历，四百八十分。乘数十二，除数十一。
○太白
晨合后伏：四十一日七百一十九分，行五十二度七百一十九分。先迟，三日益疾十六分。历，四十一度七百一十九分。乘数七百九十七，除数二百九。
夕疾行：百七十一日，行二百六度。先疾，五日益迟九分。历，百七十一度乘数七百九十七，除数二百九。
夕平行：十二日，行十二度。历，十二度。乘数五百一十五，除数百五十六。
夕迟行：四十二日，行三十一度，先疾，日益迟十分。历，四十二度。乘数五百一十五，除数百三十七。
夕留：八日。历，八度。乘数五百一十五，除数九十二。
夕退：十日，退五度。先迟，日益疾九分。历，十度。乘数五百一十五，除数八十六。
夕合前伏：六日，退五度。先疾，日益迟十五分。历，六度。乘数五百一十五，除数八十四。
夕合后伏：六日，退五度。先迟，日益疾十五分。历，六度。乘数五百一十五，除数八十三。
晨退：十日，退五度。先疾，日益迟九分。历，十度。乘数五百一十五，除数八十四。
晨留：八日，历八度。乘数五百一十五，除数八十六。
晨迟行：四十二日，行三十一度。先迟，日益疾十分。历，四十二度。乘数五百一十五，除数九十二。
晨平行：十二日，行十二度。历，十二度。乘数五百一十五，除数百三十七。
晨疾行：百七十一日，行二百六度。先迟，五日益疾九分。历，百七十一度。乘数五百一十五，除数百五十六。
晨合前伏：四十一日七百一十九分，行五十二度七百一十九分。先疾，三日益迟十六分。历，四十一度七百一十九分。乘数七百九十七，除数二百九。
○辰星
晨合后伏：十六日七百一十五分，行三十三度七百一十五分。先迟，日益疾二十二分。历，十六度七百一十五分。乘数二百八十六，除数二百八十七。
夕疾行：十二日，行十七度。先疾，日益迟五十分。历，十二度。乘数二百八十六，除数二百八十七。
夕平行：九日，行九度。历，九度。乘数四百九十五，除数百九十四。
夕迟行：六日，行四度。先疾，日益迟七十六分。历，六度。乘数四百九十六，除数百九十五。
夕留：三日。历，三度。乘数四百九十七，除数百九十六。
夕合前伏：十一日，退六度。先迟，日益疾三十一分。历，十一度。乘数四百九十八，除数百九十七。
夕合后伏：十一日，退六度。先疾，日益迟三十一分。历，十一度。乘数五百，除数百九十八。
晨留：三日。历，三度。乘数四百九十八，除数百九十八。
晨迟行：六日，行四度。先迟，日益疾七十六分。历，六度。乘数四百九十七，除数百九十六。
晨平行：九日，行九度。历，九度。乘数四百九十六，除数百九十五。
晨疾行，十二日，行十七度。先迟，日益疾五十分。历，十二度。乘数四百九十二，除数百九十四。
晨合前伏：十六日七百一十五分，行三十三度七百一十五分。先疾，日益迟二十二分。历，十六度七百一十五分。乘数二百八十六，除数二百八十七。
各置其本进退变率与后变率。同名者，相消为差。在进前少，在退前多，各以差为加；在进前多，在退前少，各以差为减。异名者，相从为并。前退后进，各以并为加；前进后退，各以并为减。逆行度率则反之。皆以差及并，加、减日度中率，各为日度变率。其水星疾行，直以差、并加、减度中率，为变率。其日直因中率为变率，勿加、减也。
以定合日与前疾初日、后疾初日与合前伏初日先后定数，各以同名者相消为差，异名者相从为并。皆四而一。所得满辰法，各为日度。乃以前日度盈加、缩减其合后伏度之变率及合前伏、前疾日之变率，亦以后日度盈减、缩加其后疾日之变率及合前伏、前疾度之变率。金水夕合，反其加减。留退亦然。其二留日之变率，若差于中率者，即以所差之数为度，各加、减本迟度之变率。谓以所多于中率之数加之，少于中率之数减之。已下加、减准此。退行度之变率，若差于中率者，即倍所差之数，各加、减本疾度之变率。其土、木二星，既无迟、疾，即加、减前、后顺行度之变率。其水星疾行度之变率，若差于中率者，即以所差之数为日，各加、减留日变率。其留日变率若少不足减者，即侵减迟日变率；若多于中率者，亦以所多之数为日，以加留日变率。各加、减变率讫，皆为日度定率。其日定率有分者，前后辈之。辈，配也，以少分配多分，满全为日。有余转配其诸变率。不加减者，皆依变率为定率。
置其星定合余，以减辰法；余以其星初日行分乘之，辰法而一，以加定合加时度，得定合后夜半星度及余。自此各依其星计日行度，所至皆从夜半为始。各以一日所行度分顺加、退减之。其行有小分者，各满其法从行分。伏不注度，留者因前，退则依减。顺行出虚，去六虚之差。退行入虚，先加此差。六虚之差，亦四而一，乃用加减。讫，皆以转法约行分，为度分，得每日所至。日度定率，或加或减，益疾益迟，每日渐差，不可预定。今且略据日度中率，商量置之。其定率既有盈缩，即差数合随而增损，当先检括诸变定率与中率相较近者因用其差，求其初、末之日行分为主。自余诸变，因此消息，加、减其差，各求初、末行分。循环比较，使际会参合，衰杀相循。其金、水皆以平行为主，前后诸变，准此求之。其合前伏，虽有日度定率，因加至合而与后算不叶者，皆从后算为定。其初见伏之度，去日不等，各以日度与星辰相较。木去日十四度，金十一度，火、土、水各十七度皆见。各减一度，皆伏。其木、火、土三星，前顺之初，后顺之末，及金、水疾行、留、退初、末，皆是见、伏之初日，注历消息定之。金、水及日、月度，皆不注分。
置日定率减一，以所差分乘之，为实。以所差日乘定日率，为法。实如法而一，为行分，得每日差。以辰法通度定率，从其分，如日定率而一，为平行度分。减日定率一，以所差分乘之，二而一，为差率。以加、减平行分，益疾者，以差率减平行为初日，加平行为末日；益迟者，以差率加平行为初日，减平行为末日。得初、末日所行度及分。其差不全而与日相合者，先置日定率减一，以所差分乘之，为实。倍所差日，为法。实如法而一，为行分。不尽者，因为小分。然后为差率。
置初日行分，益迟者，以每日差累减之；益疾者，以每日差累加之：得次日所行度分。其每日差及初日行，皆有小分。母既不同，当令同之，乃用加、减。
其先定日数而求度者，减所求日一，以每日差乘之，二而一。所得以加、减初日行分，益迟减之，益疾加之。以所求日乘之，如辰法而一，为度。不尽者，为行分，得从初日至所求日积度及分。
若先定度数而返求日者，以辰法乘所求行度。有分者，从之。八之，如每日差而一，为积。倍初日行分，以每日差加、减之，益迟者加之，益疾者减之。如每日差而一，为率。令自乘，以积加、减之。益迟者以积减之，益疾者以积加之。开方除之，所得以率加、减之。益迟者以率加之，益疾者以率减之。乃半之，得所求日数。开方除者，置所开之数为实。借一算于实之下，名曰下法。步之，超一位。置商于上方，副商于下法之上，名曰方法。命上商以除实。毕，倍方法一折，下法再折。乃置后商于下法之上，名曰隅法。副隅并方。命后商以除实。毕，隅从方法折下，就除如前开之。
五星前变，入阳爻，为黄道北；入阴爻，为黄道南。后变，入阳爻，为黄道南；入阴爻，为黄道北。其金、水二星，以夕为前变，晨为后变。各计其变行，起初日入爻之算，尽老象上爻未算之数。不满变行度常率者，因置其数以变行日定率乘之，如变行度常率而一，为日。其入变日数与此日数已下者，星在道南北依本所入阴阳爻为定。过此日数之外者，南北返之。
《九执历》者，出于西域。开元六年，诏太史监瞿坛悉达译之。断取近距，以开元二年二月朔为历首。度法六十。月有二十九日，余七百三分日之三百七十三。历首有朔虚分百二十六。周天三百六十度，无余分。日去没分九百分度之十三。二月为时，六时为岁。三十度为相，十二相而周天。望前曰白博义；望后曰黑博义。其算皆以字书，不用筹策。其术繁碎，或幸而中，不可以为法。名数诡异，初莫之辩也。陈玄景等持以惑当时，谓一行写其术未尽，妄矣。
